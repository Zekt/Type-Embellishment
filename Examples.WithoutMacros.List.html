<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Examples.WithoutMacros.List</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--with-K</a> <a id="29" class="Symbol">#-}</a>

<a id="34" class="Keyword">module</a> <a id="41" href="Examples.WithoutMacros.List.html" class="Module">Examples.WithoutMacros.List</a> <a id="69" class="Keyword">where</a>

<a id="76" class="Keyword">open</a> <a id="81" class="Keyword">import</a> <a id="88" href="Prelude.html" class="Module">Prelude</a>

<a id="97" class="Comment">--open import Generics.Description</a>
<a id="132" class="Comment">--open import Generics.Recursion</a>
<a id="165" class="Comment">--open import Generics.Reflection</a>
<a id="199" class="Comment">--</a>
<a id="202" class="Comment">--open import Generics.RecursionScheme</a>
<a id="241" class="Comment">--open import Generics.Ornament</a>
<a id="273" class="Comment">--open import Generics.Ornament.Description</a>
<a id="317" class="Comment">--open import Generics.Ornament.Algebraic</a>
<a id="359" class="Comment">--open import Generics.Ornament.Algebraic.Isomorphism</a>
<a id="413" class="Comment">--open import Generics.SimpleContainer</a>
<a id="452" class="Comment">--open import Generics.SimpleContainer.All</a>
<a id="495" class="Comment">--open import Generics.SimpleContainer.Any</a>

<a id="539" class="Keyword">open</a> <a id="544" class="Keyword">import</a> <a id="551" href="Examples.WithoutMacros.Nat.html" class="Module">Examples.WithoutMacros.Nat</a>

<a id="579" class="Comment">--------</a>
<a id="588" class="Comment">-- Connecting with the existing List datatype</a>

<a id="635" class="Comment">--instance</a>
<a id="646" class="Comment">--</a>
<a id="649" class="Comment">--  ListC : Named (quote List) _</a>
<a id="682" class="Comment">--  unNamed ListC = genDataC ListD (genDataT ListD List)</a>
<a id="739" class="Comment">--    where ListD = genDataD List</a>
<a id="773" class="Comment">--</a>
<a id="776" class="Comment">--  ListO : DataO (findDataD (quote List)) (findDataD (quote ℕ))</a>
<a id="841" class="Comment">--  ListO = record</a>
<a id="860" class="Comment">--    { level  = λ _ → tt</a>
<a id="886" class="Comment">--    ; applyL = λ (ℓ , _) → record</a>
<a id="922" class="Comment">--        { param  = λ _ → tt</a>
<a id="952" class="Comment">--        ; index  = λ _ _ → tt</a>
<a id="984" class="Comment">--        ; applyP = λ _ → ι ∷ ∺ (Δ[ _ ] ρ ι ι) ∷ ∺ [] } }</a>
<a id="1043" class="Comment">--</a>
<a id="1046" class="Comment">--  ListFin : Finitary (findDataD (quote List))</a>
<a id="1094" class="Comment">--  ListFin = [] ∷ (tt ∷ refl ∷ []) ∷ []</a>
<a id="1135" class="Comment">--</a>
<a id="1138" class="Comment">--  ListS : SCᵈ (findDataD (quote List))</a>
<a id="1179" class="Comment">--  ListS = record</a>
<a id="1198" class="Comment">--    { El  = λ (A , _) → A</a>
<a id="1226" class="Comment">--    ; pos = [] ∷ (true ∷ tt ∷ []) ∷ []</a>
<a id="1267" class="Comment">--    ; coe = λ _ → lift tt ,ωω (refl ,ωω λ _ → lift tt) ,ωω lift tt }</a>
<a id="1338" class="Comment">--</a>
<a id="1341" class="Comment">----------</a>
<a id="1352" class="Comment">---- Connecting with the existing foldr function and deriving the fold fusion theorem</a>
<a id="1438" class="Comment">--</a>
<a id="1441" class="Comment">--private</a>
<a id="1451" class="Comment">--  foldListP : FoldP</a>
<a id="1473" class="Comment">--  foldListP = fold-operator (quote List)</a>

<a id="1517" class="Comment">-- Generate foldList and its wrapper and connection, and then replace it with foldr</a>
<a id="1601" class="Comment">--unquoteDecl foldList = defineFold foldListP foldList</a>
<a id="foldList"></a><a id="1656" href="Examples.WithoutMacros.List.html#1656" class="Function">foldList</a> <a id="1665" class="Symbol">:</a> <a id="1667" class="Symbol">{</a><a id="1668" href="Examples.WithoutMacros.List.html#1668" class="Bound">ℓ</a> <a id="1670" href="Examples.WithoutMacros.List.html#1670" class="Bound">ℓ1</a> <a id="1673" class="Symbol">:</a> <a id="1675" href="Agda.Primitive.html#582" class="Postulate">Level</a><a id="1680" class="Symbol">}</a> <a id="1682" class="Symbol">{</a><a id="1683" href="Examples.WithoutMacros.List.html#1683" class="Bound">p</a> <a id="1685" class="Symbol">:</a> <a id="1687" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="1691" href="Examples.WithoutMacros.List.html#1670" class="Bound">ℓ1</a><a id="1693" class="Symbol">}</a> <a id="1695" class="Symbol">{</a><a id="1696" href="Examples.WithoutMacros.List.html#1696" class="Bound">X</a> <a id="1698" class="Symbol">:</a> <a id="1700" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="1704" href="Examples.WithoutMacros.List.html#1668" class="Bound">ℓ</a><a id="1705" class="Symbol">}</a> <a id="1707" class="Symbol">(</a><a id="1708" href="Examples.WithoutMacros.List.html#1708" class="Bound">alg</a> <a id="1712" class="Symbol">:</a> <a id="1714" href="Examples.WithoutMacros.List.html#1696" class="Bound">X</a><a id="1715" class="Symbol">)</a>
           <a id="1728" class="Symbol">(</a><a id="1729" href="Examples.WithoutMacros.List.html#1729" class="Bound">alg1</a> <a id="1734" class="Symbol">:</a> <a id="1736" class="Symbol">(</a><a id="1737" href="Examples.WithoutMacros.List.html#1737" class="Bound">a</a> <a id="1739" class="Symbol">:</a> <a id="1741" href="Examples.WithoutMacros.List.html#1683" class="Bound">p</a><a id="1742" class="Symbol">)</a> <a id="1744" class="Symbol">(</a><a id="1745" href="Examples.WithoutMacros.List.html#1745" class="Bound">z</a> <a id="1747" class="Symbol">:</a> <a id="1749" href="Examples.WithoutMacros.List.html#1696" class="Bound">X</a><a id="1750" class="Symbol">)</a> <a id="1752" class="Symbol">→</a> <a id="1754" href="Examples.WithoutMacros.List.html#1696" class="Bound">X</a><a id="1755" class="Symbol">)</a> <a id="1757" class="Symbol">(</a><a id="1758" href="Examples.WithoutMacros.List.html#1758" class="Bound">l</a> <a id="1760" class="Symbol">:</a> <a id="1762" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1767" href="Examples.WithoutMacros.List.html#1683" class="Bound">p</a><a id="1768" class="Symbol">)</a> <a id="1770" class="Symbol">→</a>
           <a id="1783" href="Examples.WithoutMacros.List.html#1696" class="Bound">X</a>
<a id="1785" href="Examples.WithoutMacros.List.html#1656" class="Function">foldList</a> <a id="1794" href="Examples.WithoutMacros.List.html#1794" class="Bound">alg</a> <a id="1798" href="Examples.WithoutMacros.List.html#1798" class="Bound">alg₁</a> <a id="1803" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="1806" class="Symbol">=</a> <a id="1808" href="Examples.WithoutMacros.List.html#1794" class="Bound">alg</a>
<a id="1812" href="Examples.WithoutMacros.List.html#1656" class="Function">foldList</a> <a id="1821" href="Examples.WithoutMacros.List.html#1821" class="Bound">alg</a> <a id="1825" href="Examples.WithoutMacros.List.html#1825" class="Bound">alg₁</a> <a id="1830" class="Symbol">(</a><a id="1831" href="Examples.WithoutMacros.List.html#1831" class="Bound">x</a> <a id="1833" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1835" href="Examples.WithoutMacros.List.html#1835" class="Bound">xs</a><a id="1837" class="Symbol">)</a> <a id="1839" class="Symbol">=</a> <a id="1841" href="Examples.WithoutMacros.List.html#1825" class="Bound">alg₁</a> <a id="1846" href="Examples.WithoutMacros.List.html#1831" class="Bound">x</a> <a id="1848" class="Symbol">(</a><a id="1849" href="Examples.WithoutMacros.List.html#1656" class="Function">foldList</a> <a id="1858" href="Examples.WithoutMacros.List.html#1821" class="Bound">alg</a> <a id="1862" href="Examples.WithoutMacros.List.html#1825" class="Bound">alg₁</a> <a id="1867" href="Examples.WithoutMacros.List.html#1835" class="Bound">xs</a><a id="1869" class="Symbol">)</a>

<a id="1872" class="Comment">--instance</a>
<a id="1883" class="Comment">--  foldrC = genFoldC&#39; foldListP foldrT</a>
<a id="1923" class="Comment">--    where</a>
<a id="1935" class="Comment">--      foldrT : FoldT foldListP</a>
<a id="1968" class="Comment">--      foldrT _ ((A , tt) , B , e , f , tt) = foldr e f</a>
<a id="2025" class="Comment">--</a>
<a id="2028" class="Comment">--private</a>
<a id="2038" class="Comment">--  foldr-fusionP : IndP</a>
<a id="2063" class="Comment">--  foldr-fusionP = fold-fusion (quote List)</a>
<a id="2108" class="Comment">--</a>
<a id="2111" class="Comment">-- unquoteDecl foldr-fusion = defineInd foldr-fusionP foldr-fusion</a>
<a id="foldr-fusion"></a><a id="2178" href="Examples.WithoutMacros.List.html#2178" class="Function">foldr-fusion</a> <a id="2191" class="Symbol">:</a>
  <a id="2195" class="Symbol">∀</a> <a id="2197" class="Symbol">{</a><a id="2198" href="Examples.WithoutMacros.List.html#2198" class="Bound">ℓ&#39;</a> <a id="2201" href="Examples.WithoutMacros.List.html#2201" class="Bound">ℓ&#39;&#39;</a> <a id="2205" href="Examples.WithoutMacros.List.html#2205" class="Bound">ℓ</a><a id="2206" class="Symbol">}</a> <a id="2208" class="Symbol">{</a><a id="2209" href="Examples.WithoutMacros.List.html#2209" class="Bound">A</a> <a id="2211" class="Symbol">:</a> <a id="2213" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="2217" href="Examples.WithoutMacros.List.html#2205" class="Bound">ℓ</a><a id="2218" class="Symbol">}</a> <a id="2220" class="Symbol">{</a><a id="2221" href="Examples.WithoutMacros.List.html#2221" class="Bound">B</a> <a id="2223" class="Symbol">:</a> <a id="2225" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="2229" href="Examples.WithoutMacros.List.html#2198" class="Bound">ℓ&#39;</a><a id="2231" class="Symbol">}</a> <a id="2233" class="Symbol">{</a><a id="2234" href="Examples.WithoutMacros.List.html#2234" class="Bound">C</a> <a id="2236" class="Symbol">:</a> <a id="2238" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="2242" href="Examples.WithoutMacros.List.html#2201" class="Bound">ℓ&#39;&#39;</a><a id="2245" class="Symbol">}</a> <a id="2247" class="Symbol">(</a><a id="2248" href="Examples.WithoutMacros.List.html#2248" class="Bound">h</a> <a id="2250" class="Symbol">:</a> <a id="2252" href="Examples.WithoutMacros.List.html#2221" class="Bound">B</a> <a id="2254" class="Symbol">→</a> <a id="2256" href="Examples.WithoutMacros.List.html#2234" class="Bound">C</a><a id="2257" class="Symbol">)</a>
  <a id="2261" class="Symbol">{</a><a id="2262" href="Examples.WithoutMacros.List.html#2262" class="Bound">e</a> <a id="2264" class="Symbol">:</a> <a id="2266" href="Examples.WithoutMacros.List.html#2221" class="Bound">B</a><a id="2267" class="Symbol">}</a> <a id="2269" class="Symbol">{</a><a id="2270" href="Examples.WithoutMacros.List.html#2270" class="Bound">f</a> <a id="2272" class="Symbol">:</a> <a id="2274" href="Examples.WithoutMacros.List.html#2209" class="Bound">A</a> <a id="2276" class="Symbol">→</a> <a id="2278" href="Examples.WithoutMacros.List.html#2221" class="Bound">B</a> <a id="2280" class="Symbol">→</a> <a id="2282" href="Examples.WithoutMacros.List.html#2221" class="Bound">B</a><a id="2283" class="Symbol">}</a> <a id="2285" class="Symbol">{</a><a id="2286" href="Examples.WithoutMacros.List.html#2286" class="Bound">e&#39;</a> <a id="2289" class="Symbol">:</a> <a id="2291" href="Examples.WithoutMacros.List.html#2234" class="Bound">C</a><a id="2292" class="Symbol">}</a> <a id="2294" class="Symbol">{</a><a id="2295" href="Examples.WithoutMacros.List.html#2295" class="Bound">f&#39;</a> <a id="2298" class="Symbol">:</a> <a id="2300" href="Examples.WithoutMacros.List.html#2209" class="Bound">A</a> <a id="2302" class="Symbol">→</a> <a id="2304" href="Examples.WithoutMacros.List.html#2234" class="Bound">C</a> <a id="2306" class="Symbol">→</a> <a id="2308" href="Examples.WithoutMacros.List.html#2234" class="Bound">C</a><a id="2309" class="Symbol">}</a>
  <a id="2313" class="Symbol">(</a><a id="2314" href="Examples.WithoutMacros.List.html#2314" class="Bound">he</a> <a id="2317" class="Symbol">:</a> <a id="2319" href="Examples.WithoutMacros.List.html#2248" class="Bound">h</a> <a id="2321" href="Examples.WithoutMacros.List.html#2262" class="Bound">e</a> <a id="2323" href="Agda.Builtin.Equality.html#124" class="Datatype Operator">≡</a> <a id="2325" href="Examples.WithoutMacros.List.html#2286" class="Bound">e&#39;</a><a id="2327" class="Symbol">)</a> <a id="2329" class="Symbol">(</a><a id="2330" href="Examples.WithoutMacros.List.html#2330" class="Bound">hf</a> <a id="2333" class="Symbol">:</a> <a id="2335" class="Symbol">(</a><a id="2336" href="Examples.WithoutMacros.List.html#2336" class="Bound">a</a> <a id="2338" class="Symbol">:</a> <a id="2340" href="Examples.WithoutMacros.List.html#2209" class="Bound">A</a><a id="2341" class="Symbol">)</a> <a id="2343" class="Symbol">(</a><a id="2344" href="Examples.WithoutMacros.List.html#2344" class="Bound">b</a> <a id="2346" class="Symbol">:</a> <a id="2348" href="Examples.WithoutMacros.List.html#2221" class="Bound">B</a><a id="2349" class="Symbol">)</a> <a id="2351" class="Symbol">(</a><a id="2352" href="Examples.WithoutMacros.List.html#2352" class="Bound">c</a> <a id="2354" class="Symbol">:</a> <a id="2356" href="Examples.WithoutMacros.List.html#2234" class="Bound">C</a><a id="2357" class="Symbol">)</a> <a id="2359" class="Symbol">→</a> <a id="2361" href="Examples.WithoutMacros.List.html#2248" class="Bound">h</a> <a id="2363" href="Examples.WithoutMacros.List.html#2344" class="Bound">b</a> <a id="2365" href="Agda.Builtin.Equality.html#124" class="Datatype Operator">≡</a> <a id="2367" href="Examples.WithoutMacros.List.html#2352" class="Bound">c</a> <a id="2369" class="Symbol">→</a> <a id="2371" href="Examples.WithoutMacros.List.html#2248" class="Bound">h</a> <a id="2373" class="Symbol">(</a><a id="2374" href="Examples.WithoutMacros.List.html#2270" class="Bound">f</a> <a id="2376" href="Examples.WithoutMacros.List.html#2336" class="Bound">a</a> <a id="2378" href="Examples.WithoutMacros.List.html#2344" class="Bound">b</a><a id="2379" class="Symbol">)</a> <a id="2381" href="Agda.Builtin.Equality.html#124" class="Datatype Operator">≡</a> <a id="2383" href="Examples.WithoutMacros.List.html#2295" class="Bound">f&#39;</a> <a id="2386" href="Examples.WithoutMacros.List.html#2336" class="Bound">a</a> <a id="2388" href="Examples.WithoutMacros.List.html#2352" class="Bound">c</a><a id="2389" class="Symbol">)</a>
  <a id="2393" class="Symbol">(</a><a id="2394" href="Examples.WithoutMacros.List.html#2394" class="Bound">as</a> <a id="2397" class="Symbol">:</a> <a id="2399" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="2404" href="Examples.WithoutMacros.List.html#2209" class="Bound">A</a><a id="2405" class="Symbol">)</a> <a id="2407" class="Symbol">→</a> <a id="2409" href="Examples.WithoutMacros.List.html#2248" class="Bound">h</a> <a id="2411" class="Symbol">(</a><a id="2412" href="Prelude.List.html#2214" class="Function">foldr</a> <a id="2418" href="Examples.WithoutMacros.List.html#2262" class="Bound">e</a> <a id="2420" href="Examples.WithoutMacros.List.html#2270" class="Bound">f</a> <a id="2422" href="Examples.WithoutMacros.List.html#2394" class="Bound">as</a><a id="2424" class="Symbol">)</a> <a id="2426" href="Agda.Builtin.Equality.html#124" class="Datatype Operator">≡</a> <a id="2428" href="Prelude.List.html#2214" class="Function">foldr</a> <a id="2434" href="Examples.WithoutMacros.List.html#2286" class="Bound">e&#39;</a> <a id="2437" href="Examples.WithoutMacros.List.html#2295" class="Bound">f&#39;</a> <a id="2440" href="Examples.WithoutMacros.List.html#2394" class="Bound">as</a>
<a id="2443" href="Examples.WithoutMacros.List.html#2178" class="Function">foldr-fusion</a> <a id="2456" href="Examples.WithoutMacros.List.html#2456" class="Bound">h</a> <a id="2458" href="Examples.WithoutMacros.List.html#2458" class="Bound">he</a> <a id="2461" href="Examples.WithoutMacros.List.html#2461" class="Bound">hf</a> <a id="2464" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="2473" class="Symbol">=</a> <a id="2475" href="Examples.WithoutMacros.List.html#2458" class="Bound">he</a>
<a id="2478" href="Examples.WithoutMacros.List.html#2178" class="Function">foldr-fusion</a> <a id="2491" href="Examples.WithoutMacros.List.html#2491" class="Bound">h</a> <a id="2493" href="Examples.WithoutMacros.List.html#2493" class="Bound">he</a> <a id="2496" href="Examples.WithoutMacros.List.html#2496" class="Bound">hf</a> <a id="2499" class="Symbol">(</a><a id="2500" href="Examples.WithoutMacros.List.html#2500" class="Bound">a</a> <a id="2502" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="2504" href="Examples.WithoutMacros.List.html#2504" class="Bound">as</a><a id="2506" class="Symbol">)</a> <a id="2508" class="Symbol">=</a> <a id="2510" href="Examples.WithoutMacros.List.html#2496" class="Bound">hf</a> <a id="2513" href="Examples.WithoutMacros.List.html#2500" class="Bound">a</a> <a id="2515" class="Symbol">_</a> <a id="2517" class="Symbol">_</a> <a id="2519" class="Symbol">(</a><a id="2520" href="Examples.WithoutMacros.List.html#2178" class="Function">foldr-fusion</a> <a id="2533" href="Examples.WithoutMacros.List.html#2491" class="Bound">h</a> <a id="2535" href="Examples.WithoutMacros.List.html#2493" class="Bound">he</a> <a id="2538" href="Examples.WithoutMacros.List.html#2496" class="Bound">hf</a> <a id="2541" href="Examples.WithoutMacros.List.html#2504" class="Bound">as</a><a id="2543" class="Symbol">)</a>

<a id="2546" class="Comment">--instance foldr-fusionC = genIndC foldr-fusionP foldr-fusion</a>
<a id="2608" class="Comment">--</a>
<a id="2611" class="Comment">----------</a>
<a id="2622" class="Comment">---- Algebraic ornamentation</a>
<a id="2651" class="Comment">--</a>
<a id="2654" class="Comment">--private</a>
<a id="2664" class="Comment">--  AlgListOD : DataOD (findDataD (quote List))</a>
<a id="2712" class="Comment">--  AlgListOD = AlgOD foldListP</a>
<a id="2744" class="Comment">--</a>
<a id="2747" class="Comment">--instance AlgListO = ⌈ AlgListOD ⌉ᵈ</a>
<a id="2784" class="Comment">--</a>
<a id="2787" class="Comment">-- unquoteDecl data AlgList constructor c0 c1 = defineByDataD ⌊ AlgListOD ⌋ᵈ AlgList (c0 ∷ c1 ∷ [])</a>
<a id="2887" class="Keyword">data</a> <a id="AlgList"></a><a id="2892" href="Examples.WithoutMacros.List.html#2892" class="Datatype">AlgList</a> <a id="2900" class="Symbol">{</a><a id="2901" href="Examples.WithoutMacros.List.html#2901" class="Bound">ℓ&#39;</a> <a id="2904" href="Examples.WithoutMacros.List.html#2904" class="Bound">ℓ</a><a id="2905" class="Symbol">}</a> <a id="2907" class="Symbol">{</a><a id="2908" href="Examples.WithoutMacros.List.html#2908" class="Bound">A</a> <a id="2910" class="Symbol">:</a> <a id="2912" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="2916" href="Examples.WithoutMacros.List.html#2904" class="Bound">ℓ</a><a id="2917" class="Symbol">}</a> <a id="2919" class="Symbol">{</a><a id="2920" href="Examples.WithoutMacros.List.html#2920" class="Bound">B</a> <a id="2922" class="Symbol">:</a> <a id="2924" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="2928" href="Examples.WithoutMacros.List.html#2901" class="Bound">ℓ&#39;</a><a id="2930" class="Symbol">}</a>
  <a id="2934" class="Symbol">(</a><a id="2935" href="Examples.WithoutMacros.List.html#2935" class="Bound">e</a> <a id="2937" class="Symbol">:</a> <a id="2939" href="Examples.WithoutMacros.List.html#2920" class="Bound">B</a><a id="2940" class="Symbol">)</a> <a id="2942" class="Symbol">(</a><a id="2943" href="Examples.WithoutMacros.List.html#2943" class="Bound">f</a> <a id="2945" class="Symbol">:</a> <a id="2947" href="Examples.WithoutMacros.List.html#2908" class="Bound">A</a> <a id="2949" class="Symbol">→</a> <a id="2951" href="Examples.WithoutMacros.List.html#2920" class="Bound">B</a> <a id="2953" class="Symbol">→</a> <a id="2955" href="Examples.WithoutMacros.List.html#2920" class="Bound">B</a><a id="2956" class="Symbol">)</a> <a id="2958" class="Symbol">:</a> <a id="2960" href="Examples.WithoutMacros.List.html#2920" class="Bound">B</a> <a id="2962" class="Symbol">→</a> <a id="2964" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="2968" class="Symbol">(</a><a id="2969" href="Examples.WithoutMacros.List.html#2904" class="Bound">ℓ</a> <a id="2971" href="Agda.Primitive.html#795" class="Primitive Operator">⊔</a> <a id="2973" href="Examples.WithoutMacros.List.html#2901" class="Bound">ℓ&#39;</a><a id="2975" class="Symbol">)</a> <a id="2977" class="Keyword">where</a>
  <a id="AlgList.[]"></a><a id="2985" href="Examples.WithoutMacros.List.html#2985" class="InductiveConstructor">[]</a>  <a id="2989" class="Symbol">:</a> <a id="2991" href="Examples.WithoutMacros.List.html#2892" class="Datatype">AlgList</a> <a id="2999" href="Examples.WithoutMacros.List.html#2935" class="Bound">e</a> <a id="3001" href="Examples.WithoutMacros.List.html#2943" class="Bound">f</a> <a id="3003" href="Examples.WithoutMacros.List.html#2935" class="Bound">e</a>
  <a id="AlgList._∷_"></a><a id="3007" href="Examples.WithoutMacros.List.html#3007" class="InductiveConstructor Operator">_∷_</a> <a id="3011" class="Symbol">:</a> <a id="3013" class="Symbol">(</a><a id="3014" href="Examples.WithoutMacros.List.html#3014" class="Bound">a</a> <a id="3016" class="Symbol">:</a> <a id="3018" href="Examples.WithoutMacros.List.html#2908" class="Bound">A</a><a id="3019" class="Symbol">)</a> <a id="3021" class="Symbol">{</a><a id="3022" href="Examples.WithoutMacros.List.html#3022" class="Bound">b</a> <a id="3024" class="Symbol">:</a> <a id="3026" href="Examples.WithoutMacros.List.html#2920" class="Bound">B</a><a id="3027" class="Symbol">}</a> <a id="3029" class="Symbol">→</a> <a id="3031" href="Examples.WithoutMacros.List.html#2892" class="Datatype">AlgList</a> <a id="3039" href="Examples.WithoutMacros.List.html#2935" class="Bound">e</a> <a id="3041" href="Examples.WithoutMacros.List.html#2943" class="Bound">f</a> <a id="3043" href="Examples.WithoutMacros.List.html#3022" class="Bound">b</a> <a id="3045" class="Symbol">→</a> <a id="3047" href="Examples.WithoutMacros.List.html#2892" class="Datatype">AlgList</a> <a id="3055" href="Examples.WithoutMacros.List.html#2935" class="Bound">e</a> <a id="3057" href="Examples.WithoutMacros.List.html#2943" class="Bound">f</a> <a id="3059" class="Symbol">(</a><a id="3060" href="Examples.WithoutMacros.List.html#2943" class="Bound">f</a> <a id="3062" href="Examples.WithoutMacros.List.html#3014" class="Bound">a</a> <a id="3064" href="Examples.WithoutMacros.List.html#3022" class="Bound">b</a><a id="3065" class="Symbol">)</a>

<a id="3068" class="Comment">--instance AlgListC = genDataC ⌊ AlgListOD ⌋ᵈ (genDataT ⌊ AlgListOD ⌋ᵈ AlgList)</a>
<a id="3148" class="Comment">--</a>
<a id="3151" class="Comment">--private</a>
<a id="3161" class="Comment">--  lengthP : FoldP</a>
<a id="3181" class="Comment">--  lengthP = forget (quote List) (quote ℕ)</a>

<a id="3226" class="Comment">--instance lengthC = genFoldC lengthP length</a>

<a id="3272" class="Comment">--private</a>
<a id="3282" class="Comment">--  VecOD : DataOD (findDataD (quote List))</a>
<a id="3326" class="Comment">--  VecOD = AlgOD lengthP</a>

<a id="3353" class="Comment">--instance VecO = ⌈ VecOD ⌉ᵈ</a>

<a id="3383" class="Comment">-- unquoteDecl data Vec constructor c0 c1 = defineByDataD ⌊ VecOD ⌋ᵈ Vec (c0 ∷ c1 ∷ [])</a>
<a id="3471" class="Keyword">data</a> <a id="Vec"></a><a id="3476" href="Examples.WithoutMacros.List.html#3476" class="Datatype">Vec</a> <a id="3480" class="Symbol">(</a><a id="3481" href="Examples.WithoutMacros.List.html#3481" class="Bound">A</a> <a id="3483" class="Symbol">:</a> <a id="3485" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="3489" href="Prelude.Level.html#316" class="Generalizable">ℓ</a><a id="3490" class="Symbol">)</a> <a id="3492" class="Symbol">:</a> <a id="3494" class="Symbol">(</a><a id="3495" href="Examples.WithoutMacros.List.html#3495" class="Bound">n</a> <a id="3497" class="Symbol">:</a> <a id="3499" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a><a id="3500" class="Symbol">)</a> <a id="3502" class="Symbol">→</a> <a id="3504" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="3508" href="Examples.WithoutMacros.List.html#3489" class="Bound">ℓ</a> <a id="3510" class="Keyword">where</a>
  <a id="Vec.[]"></a><a id="3518" href="Examples.WithoutMacros.List.html#3518" class="InductiveConstructor">[]</a>  <a id="3522" class="Symbol">:</a> <a id="3524" href="Examples.WithoutMacros.List.html#3476" class="Datatype">Vec</a> <a id="3528" href="Examples.WithoutMacros.List.html#3481" class="Bound">A</a> <a id="3530" class="Number">0</a>
  <a id="Vec._∷_"></a><a id="3534" href="Examples.WithoutMacros.List.html#3534" class="InductiveConstructor Operator">_∷_</a> <a id="3538" class="Symbol">:</a> <a id="3540" class="Symbol">(</a><a id="3541" href="Examples.WithoutMacros.List.html#3541" class="Bound">a</a> <a id="3543" class="Symbol">:</a> <a id="3545" href="Examples.WithoutMacros.List.html#3481" class="Bound">A</a><a id="3546" class="Symbol">)</a> <a id="3548" class="Symbol">{</a><a id="3549" href="Examples.WithoutMacros.List.html#3549" class="Bound">n</a> <a id="3551" class="Symbol">:</a> <a id="3553" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a><a id="3554" class="Symbol">}</a> <a id="3556" class="Symbol">→</a> <a id="3558" href="Examples.WithoutMacros.List.html#3476" class="Datatype">Vec</a> <a id="3562" href="Examples.WithoutMacros.List.html#3481" class="Bound">A</a> <a id="3564" href="Examples.WithoutMacros.List.html#3549" class="Bound">n</a> <a id="3566" class="Symbol">→</a> <a id="3568" href="Examples.WithoutMacros.List.html#3476" class="Datatype">Vec</a> <a id="3572" href="Examples.WithoutMacros.List.html#3481" class="Bound">A</a> <a id="3574" class="Symbol">(</a><a id="3575" href="Agda.Builtin.Nat.html#208" class="InductiveConstructor">suc</a> <a id="3579" href="Examples.WithoutMacros.List.html#3549" class="Bound">n</a><a id="3580" class="Symbol">)</a>

<a id="3583" class="Comment">--instance</a>
<a id="3594" class="Comment">--</a>
<a id="3597" class="Comment">--  VecC : Named (quote Vec) _</a>
<a id="3628" class="Comment">--  unNamed VecC = genDataC ⌊ VecOD ⌋ᵈ (genDataT ⌊ VecOD ⌋ᵈ Vec)</a>

<a id="3694" class="Comment">--  VecFin : Finitary ⌊ VecOD ⌋ᵈ</a>
<a id="3727" class="Comment">--  VecFin = [] ∷ (tt ∷ tt ∷ refl ∷ []) ∷ []</a>
<a id="3772" class="Comment">--</a>
<a id="3775" class="Comment">--private</a>
<a id="3785" class="Comment">--  fromVecP : FoldP</a>
<a id="3806" class="Comment">--  fromVecP = forget (quote Vec) (quote List)</a>

<a id="3854" class="Comment">-- unquoteDecl fromVec = defineFold fromVecP fromVec</a>
<a id="fromVec"></a><a id="3907" href="Examples.WithoutMacros.List.html#3907" class="Function">fromVec</a> <a id="3915" class="Symbol">:</a> <a id="3917" class="Symbol">{</a><a id="3918" href="Examples.WithoutMacros.List.html#3918" class="Bound">A</a> <a id="3920" class="Symbol">:</a> <a id="3922" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="3926" href="Prelude.Level.html#316" class="Generalizable">ℓ</a><a id="3927" class="Symbol">}</a> <a id="3929" class="Symbol">{</a><a id="3930" href="Examples.WithoutMacros.List.html#3930" class="Bound">n</a> <a id="3932" class="Symbol">:</a> <a id="3934" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a><a id="3935" class="Symbol">}</a> <a id="3937" class="Symbol">(</a><a id="3938" href="Examples.WithoutMacros.List.html#3938" class="Bound">v</a> <a id="3940" class="Symbol">:</a> <a id="3942" href="Examples.WithoutMacros.List.html#3476" class="Datatype">Vec</a> <a id="3946" href="Examples.WithoutMacros.List.html#3918" class="Bound">A</a> <a id="3948" href="Examples.WithoutMacros.List.html#3930" class="Bound">n</a><a id="3949" class="Symbol">)</a> <a id="3951" class="Symbol">→</a> <a id="3953" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="3958" href="Examples.WithoutMacros.List.html#3918" class="Bound">A</a>
<a id="3960" href="Examples.WithoutMacros.List.html#3907" class="Function">fromVec</a> <a id="3968" href="Examples.WithoutMacros.List.html#3518" class="InductiveConstructor">[]</a>       <a id="3977" class="Symbol">=</a> <a id="3979" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
<a id="3982" href="Examples.WithoutMacros.List.html#3907" class="Function">fromVec</a> <a id="3990" class="Symbol">(</a><a id="3991" href="Examples.WithoutMacros.List.html#3991" class="Bound">a</a> <a id="3993" href="Examples.WithoutMacros.List.html#3534" class="InductiveConstructor Operator">∷</a> <a id="3995" href="Examples.WithoutMacros.List.html#3995" class="Bound">as</a><a id="3997" class="Symbol">)</a> <a id="3999" class="Symbol">=</a> <a id="4001" href="Examples.WithoutMacros.List.html#3991" class="Bound">a</a> <a id="4003" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="4005" href="Examples.WithoutMacros.List.html#3907" class="Function">fromVec</a> <a id="4013" href="Examples.WithoutMacros.List.html#3995" class="Bound">as</a>

<a id="4017" class="Comment">--instance fromVecC = genFoldC fromVecP fromVec</a>
<a id="4065" class="Comment">--</a>
<a id="4068" class="Comment">--private</a>
<a id="4078" class="Comment">--  toVecP : IndP</a>
<a id="4096" class="Comment">--  toVecP = remember (quote Vec)</a>
<a id="4130" class="Comment">--</a>
<a id="4133" class="Comment">-- unquoteDecl toVec = defineInd toVecP toVec</a>
<a id="toVec"></a><a id="4179" href="Examples.WithoutMacros.List.html#4179" class="Function">toVec</a> <a id="4185" class="Symbol">:</a>  <a id="4188" class="Symbol">{</a><a id="4189" href="Examples.WithoutMacros.List.html#4189" class="Bound">A</a> <a id="4191" class="Symbol">:</a> <a id="4193" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="4197" href="Prelude.Level.html#316" class="Generalizable">ℓ</a><a id="4198" class="Symbol">}</a> <a id="4200" class="Symbol">(</a><a id="4201" href="Examples.WithoutMacros.List.html#4201" class="Bound">as</a> <a id="4204" class="Symbol">:</a> <a id="4206" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="4211" href="Examples.WithoutMacros.List.html#4189" class="Bound">A</a><a id="4212" class="Symbol">)</a> <a id="4214" class="Symbol">→</a> <a id="4216" href="Examples.WithoutMacros.List.html#3476" class="Datatype">Vec</a> <a id="4220" href="Examples.WithoutMacros.List.html#4189" class="Bound">A</a> <a id="4222" class="Symbol">(</a><a id="4223" href="Prelude.List.html#2889" class="Function">length</a> <a id="4230" href="Examples.WithoutMacros.List.html#4201" class="Bound">as</a><a id="4232" class="Symbol">)</a>
<a id="4234" href="Examples.WithoutMacros.List.html#4179" class="Function">toVec</a> <a id="4240" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="4249" class="Symbol">=</a> <a id="4251" href="Examples.WithoutMacros.List.html#3518" class="InductiveConstructor">[]</a>
<a id="4254" href="Examples.WithoutMacros.List.html#4179" class="Function">toVec</a> <a id="4260" class="Symbol">(</a><a id="4261" href="Examples.WithoutMacros.List.html#4261" class="Bound">a</a> <a id="4263" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="4265" href="Examples.WithoutMacros.List.html#4265" class="Bound">as</a><a id="4267" class="Symbol">)</a> <a id="4269" class="Symbol">=</a> <a id="4271" href="Examples.WithoutMacros.List.html#4261" class="Bound">a</a> <a id="4273" href="Examples.WithoutMacros.List.html#3534" class="InductiveConstructor Operator">∷</a> <a id="4275" href="Examples.WithoutMacros.List.html#4179" class="Function">toVec</a> <a id="4281" href="Examples.WithoutMacros.List.html#4265" class="Bound">as</a>

<a id="4285" class="Comment">--instance toVecC = genIndC toVecP toVec</a>
<a id="4326" class="Comment">--</a>
<a id="4329" class="Comment">--private</a>
<a id="4339" class="Comment">--  from-toVecP : IndP</a>
<a id="4362" class="Comment">--  from-toVecP = forget-remember-inv (quote Vec) (quote List) (inl it)</a>
<a id="4434" class="Comment">--</a>
<a id="4437" class="Comment">-- unquoteDecl from-toVec = defineInd from-toVecP from-toVec</a>
<a id="4498" class="Comment">-- from-toVec : {A : Set ℓ} (as : List A) → fromVec (toVec as) ≡ as</a>
<a id="4566" class="Comment">-- from-toVec []       = refl</a>
<a id="4596" class="Comment">-- from-toVec (a ∷ as) = cong (_∷_ a) (from-toVec as)</a>

<a id="4651" class="Comment">--instance from-toVecC = genIndC from-toVecP from-toVec</a>
<a id="4707" class="Comment">--</a>
<a id="4710" class="Comment">--private</a>
<a id="4720" class="Comment">--  to-fromVecP : IndP</a>
<a id="4743" class="Comment">--  to-fromVecP = remember-forget-inv (quote Vec) (quote List) (inl it)</a>
<a id="4815" class="Comment">--</a>
<a id="4818" class="Comment">-- unquoteDecl to-fromVec = defineInd to-fromVecP to-fromVec</a>
<a id="4879" class="Comment">--to-fromVec : {A : Set ℓ} {n : ℕ} (as : Vec A n) →</a>
<a id="4931" class="Comment">--             (length (fromVec as) , toVec (fromVec as)) ≡ ((n , as) ⦂ Σ ℕ (Vec A))</a>
<a id="5016" class="Comment">--to-fromVec [] = refl</a>
<a id="5039" class="Comment">--to-fromVec {ℓ} (a ∷ as) =</a>
<a id="5067" class="Comment">--  trans</a>
<a id="5077" class="Comment">--   (cong {ℓ}</a>
<a id="5092" class="Comment">--    (bimap {lzero} (λ x₁ → x₁) (DataC.toN (findDataC (quote Vec))))</a>
<a id="5162" class="Comment">--    (cong (bimap {lzero} (λ x₁ → x₁) inr)</a>
<a id="5206" class="Comment">--     (cong (bimap (λ x₁ → x₁) inl)</a>
<a id="5243" class="Comment">--      (cong (bimap (λ x₁ → x₁) (λ section → a , section))</a>
<a id="5303" class="Comment">--       (trans</a>
<a id="5319" class="Comment">--        (cong (λ p₁ → suc (fst p₁) , fst p₁ , snd p₁ , refl)</a>
<a id="5382" class="Comment">--         (to-fromVec as))</a>
<a id="5410" class="Comment">--        refl)))))</a>
<a id="5430" class="Comment">--   refl</a>

<a id="5441" class="Comment">--instance to-fromVecC = genIndC to-fromVecP to-fromVec</a>
<a id="5497" class="Comment">--</a>
<a id="5500" class="Comment">--private</a>
<a id="5510" class="Comment">--  LenOD : DataOD (findDataD (quote Vec))</a>
<a id="5553" class="Comment">--  LenOD = AlgOD fromVecP</a>

<a id="5581" class="Comment">--instance LenO = ⌈ LenOD ⌉ᵈ</a>

<a id="5611" class="Comment">-- unquoteDecl data Len constructor c0 c1 = defineByDataD ⌊ LenOD ⌋ᵈ Len (c0 ∷ c1 ∷ [])</a>
<a id="5699" class="Keyword">data</a> <a id="Len"></a><a id="5704" href="Examples.WithoutMacros.List.html#5704" class="Datatype">Len</a> <a id="5708" class="Symbol">{</a><a id="5709" href="Examples.WithoutMacros.List.html#5709" class="Bound">A</a> <a id="5711" class="Symbol">:</a> <a id="5713" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="5717" href="Prelude.Level.html#316" class="Generalizable">ℓ</a><a id="5718" class="Symbol">}</a> <a id="5720" class="Symbol">:</a> <a id="5722" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a> <a id="5724" class="Symbol">→</a> <a id="5726" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5731" href="Examples.WithoutMacros.List.html#5709" class="Bound">A</a> <a id="5733" class="Symbol">→</a> <a id="5735" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="5739" href="Examples.WithoutMacros.List.html#5717" class="Bound">ℓ</a> <a id="5741" class="Keyword">where</a>
  <a id="Len.zero"></a><a id="5749" href="Examples.WithoutMacros.List.html#5749" class="InductiveConstructor">zero</a> <a id="5754" class="Symbol">:</a> <a id="5756" href="Examples.WithoutMacros.List.html#5704" class="Datatype">Len</a> <a id="5760" class="Number">0</a> <a id="5762" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
  <a id="Len.suc"></a><a id="5767" href="Examples.WithoutMacros.List.html#5767" class="InductiveConstructor">suc</a>  <a id="5772" class="Symbol">:</a> <a id="5774" class="Symbol">{</a><a id="5775" href="Examples.WithoutMacros.List.html#5775" class="Bound">a</a> <a id="5777" class="Symbol">:</a> <a id="5779" href="Examples.WithoutMacros.List.html#5709" class="Bound">A</a><a id="5780" class="Symbol">}</a> <a id="5782" class="Symbol">{</a><a id="5783" href="Examples.WithoutMacros.List.html#5783" class="Bound">n</a> <a id="5785" class="Symbol">:</a> <a id="5787" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a><a id="5788" class="Symbol">}</a> <a id="5790" class="Symbol">{</a><a id="5791" href="Examples.WithoutMacros.List.html#5791" class="Bound">as</a> <a id="5794" class="Symbol">:</a> <a id="5796" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5801" href="Examples.WithoutMacros.List.html#5709" class="Bound">A</a><a id="5802" class="Symbol">}</a> <a id="5804" class="Symbol">→</a> <a id="5806" href="Examples.WithoutMacros.List.html#5704" class="Datatype">Len</a> <a id="5810" href="Examples.WithoutMacros.List.html#5783" class="Bound">n</a> <a id="5812" href="Examples.WithoutMacros.List.html#5791" class="Bound">as</a> <a id="5815" class="Symbol">→</a> <a id="5817" href="Examples.WithoutMacros.List.html#5704" class="Datatype">Len</a> <a id="5821" class="Symbol">(</a><a id="5822" href="Agda.Builtin.Nat.html#208" class="InductiveConstructor">suc</a> <a id="5826" href="Examples.WithoutMacros.List.html#5783" class="Bound">n</a><a id="5827" class="Symbol">)</a> <a id="5829" class="Symbol">(</a><a id="5830" href="Examples.WithoutMacros.List.html#5775" class="Bound">a</a> <a id="5832" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="5834" href="Examples.WithoutMacros.List.html#5791" class="Bound">as</a><a id="5836" class="Symbol">)</a>

<a id="5839" class="Comment">--instance</a>
<a id="5850" class="Comment">--  LenC : Named (quote Len) _</a>
<a id="5881" class="Comment">--  unNamed LenC = genDataC ⌊ LenOD ⌋ᵈ (genDataT ⌊ LenOD ⌋ᵈ Len)</a>

<a id="5947" class="Comment">--private</a>
<a id="5957" class="Comment">--  fromLenP : FoldP</a>
<a id="5978" class="Comment">--  fromLenP = forget (quote Len) (quote Vec)</a>
<a id="6024" class="Comment">--</a>
<a id="6027" class="Comment">-- unquoteDecl fromLen = defineFold fromLenP fromLen</a>
<a id="fromLen"></a><a id="6080" href="Examples.WithoutMacros.List.html#6080" class="Function">fromLen</a> <a id="6088" class="Symbol">:</a> <a id="6090" class="Symbol">{</a><a id="6091" href="Examples.WithoutMacros.List.html#6091" class="Bound">A</a> <a id="6093" class="Symbol">:</a> <a id="6095" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="6099" href="Prelude.Level.html#316" class="Generalizable">ℓ</a><a id="6100" class="Symbol">}</a> <a id="6102" class="Symbol">{</a><a id="6103" href="Examples.WithoutMacros.List.html#6103" class="Bound">n</a> <a id="6105" class="Symbol">:</a> <a id="6107" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a><a id="6108" class="Symbol">}</a> <a id="6110" class="Symbol">{</a><a id="6111" href="Examples.WithoutMacros.List.html#6111" class="Bound">as</a> <a id="6114" class="Symbol">:</a> <a id="6116" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="6121" href="Examples.WithoutMacros.List.html#6091" class="Bound">A</a><a id="6122" class="Symbol">}</a> <a id="6124" class="Symbol">→</a> <a id="6126" href="Examples.WithoutMacros.List.html#5704" class="Datatype">Len</a> <a id="6130" href="Examples.WithoutMacros.List.html#6103" class="Bound">n</a> <a id="6132" href="Examples.WithoutMacros.List.html#6111" class="Bound">as</a> <a id="6135" class="Symbol">→</a> <a id="6137" href="Examples.WithoutMacros.List.html#3476" class="Datatype">Vec</a> <a id="6141" href="Examples.WithoutMacros.List.html#6091" class="Bound">A</a> <a id="6143" href="Examples.WithoutMacros.List.html#6103" class="Bound">n</a>
<a id="6145" href="Examples.WithoutMacros.List.html#6080" class="Function">fromLen</a>  <a id="6154" href="Examples.WithoutMacros.List.html#5749" class="InductiveConstructor">zero</a>       <a id="6165" class="Symbol">=</a> <a id="6167" href="Examples.WithoutMacros.List.html#3518" class="InductiveConstructor">[]</a>
<a id="6170" href="Examples.WithoutMacros.List.html#6080" class="Function">fromLen</a> <a id="6178" class="Symbol">(</a><a id="6179" href="Examples.WithoutMacros.List.html#5767" class="InductiveConstructor">suc</a> <a id="6183" class="Symbol">{</a><a id="6184" href="Examples.WithoutMacros.List.html#6184" class="Bound">a</a><a id="6185" class="Symbol">}</a> <a id="6187" href="Examples.WithoutMacros.List.html#6187" class="Bound">l</a><a id="6188" class="Symbol">)</a> <a id="6190" class="Symbol">=</a> <a id="6192" href="Examples.WithoutMacros.List.html#6184" class="Bound">a</a> <a id="6194" href="Examples.WithoutMacros.List.html#3534" class="InductiveConstructor Operator">∷</a> <a id="6196" href="Examples.WithoutMacros.List.html#6080" class="Function">fromLen</a> <a id="6204" href="Examples.WithoutMacros.List.html#6187" class="Bound">l</a>

<a id="6207" class="Comment">--instance fromLenC = genFoldC fromLenP fromLen</a>
<a id="6255" class="Comment">--</a>
<a id="6258" class="Comment">--private</a>
<a id="6268" class="Comment">--  toLenP : IndP</a>
<a id="6286" class="Comment">--  toLenP = remember (quote Len)</a>
<a id="6320" class="Comment">--</a>
<a id="6323" class="Comment">-- unquoteDecl toLen = defineInd toLenP toLen</a>
<a id="toLen"></a><a id="6369" href="Examples.WithoutMacros.List.html#6369" class="Function">toLen</a> <a id="6375" class="Symbol">:</a> <a id="6377" class="Symbol">{</a><a id="6378" href="Examples.WithoutMacros.List.html#6378" class="Bound">A</a> <a id="6380" class="Symbol">:</a> <a id="6382" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="6386" href="Prelude.Level.html#316" class="Generalizable">ℓ</a><a id="6387" class="Symbol">}</a> <a id="6389" class="Symbol">{</a><a id="6390" href="Examples.WithoutMacros.List.html#6390" class="Bound">n</a> <a id="6392" class="Symbol">:</a> <a id="6394" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a><a id="6395" class="Symbol">}</a> <a id="6397" class="Symbol">(</a><a id="6398" href="Examples.WithoutMacros.List.html#6398" class="Bound">as</a> <a id="6401" class="Symbol">:</a> <a id="6403" href="Examples.WithoutMacros.List.html#3476" class="Datatype">Vec</a> <a id="6407" href="Examples.WithoutMacros.List.html#6378" class="Bound">A</a> <a id="6409" href="Examples.WithoutMacros.List.html#6390" class="Bound">n</a><a id="6410" class="Symbol">)</a> <a id="6412" class="Symbol">→</a> <a id="6414" href="Examples.WithoutMacros.List.html#5704" class="Datatype">Len</a> <a id="6418" href="Examples.WithoutMacros.List.html#6390" class="Bound">n</a> <a id="6420" class="Symbol">(</a><a id="6421" href="Examples.WithoutMacros.List.html#3907" class="Function">fromVec</a> <a id="6429" href="Examples.WithoutMacros.List.html#6398" class="Bound">as</a><a id="6431" class="Symbol">)</a>
<a id="6433" href="Examples.WithoutMacros.List.html#6369" class="Function">toLen</a> <a id="6439" href="Examples.WithoutMacros.List.html#3518" class="InductiveConstructor">[]</a>       <a id="6448" class="Symbol">=</a> <a id="6450" href="Examples.WithoutMacros.List.html#5749" class="InductiveConstructor">zero</a>
<a id="6455" href="Examples.WithoutMacros.List.html#6369" class="Function">toLen</a> <a id="6461" class="Symbol">(</a><a id="6462" href="Examples.WithoutMacros.List.html#6462" class="Bound">a</a> <a id="6464" href="Examples.WithoutMacros.List.html#3534" class="InductiveConstructor Operator">∷</a> <a id="6466" href="Examples.WithoutMacros.List.html#6466" class="Bound">as</a><a id="6468" class="Symbol">)</a> <a id="6470" class="Symbol">=</a> <a id="6472" href="Examples.WithoutMacros.List.html#5767" class="InductiveConstructor">suc</a> <a id="6476" class="Symbol">(</a><a id="6477" href="Examples.WithoutMacros.List.html#6369" class="Function">toLen</a> <a id="6483" href="Examples.WithoutMacros.List.html#6466" class="Bound">as</a><a id="6485" class="Symbol">)</a>

<a id="6488" class="Comment">--instance toLenC = genIndC toLenP toLen</a>
<a id="6529" class="Comment">--</a>
<a id="6532" class="Comment">--private</a>
<a id="6542" class="Comment">--  from-toLenP : IndP</a>
<a id="6565" class="Comment">--  from-toLenP = forget-remember-inv (quote Len) (quote Vec) (inl it)</a>
<a id="6636" class="Comment">--</a>
<a id="6639" class="Comment">-- unquoteDecl from-toLen = defineInd from-toLenP from-toLen</a>
<a id="6700" class="Comment">-- from-toLen : {A : Set ℓ} {n : ℕ} (as : Vec A n) → fromLen (toLen as) ≡ as</a>
<a id="6777" class="Comment">-- from-toLen []       = refl</a>
<a id="6807" class="Comment">-- from-toLen (a ∷ as) = cong (_∷_ a) (from-toLen as)</a>

<a id="6862" class="Comment">--instance from-toLenC = genIndC from-toLenP from-toLen</a>
<a id="6918" class="Comment">--</a>
<a id="6921" class="Comment">--private</a>
<a id="6931" class="Comment">--  to-fromLenP : IndP</a>
<a id="6954" class="Comment">--  to-fromLenP = remember-forget-inv (quote Len) (quote Vec) (inl it)</a>
<a id="7025" class="Comment">--</a>
<a id="7028" class="Comment">-- unquoteDecl to-fromLen = defineInd to-fromLenP to-fromLen</a>
<a id="7089" class="Comment">--to-fromLen : {A : Set ℓ} {n : ℕ} {as : List A} (l : Len n as)</a>
<a id="7153" class="Comment">--           → (fromVec (fromLen l) , toLen (fromLen l))</a>
<a id="7210" class="Comment">--           ≡ ((as , l) ⦂ Σ[ as&#39; ∈ List A ] Len n as&#39;)</a>
<a id="7266" class="Comment">--to-fromLen                      zero   = refl</a>
<a id="7314" class="Comment">--to-fromLen {ℓ} {n = suc n} {a ∷ _} (suc l) =</a>
<a id="7361" class="Comment">--  trans</a>
<a id="7371" class="Comment">--   (cong</a>
<a id="7382" class="Comment">--    (bimap (λ x → x) (DataC.toN (findDataC (quote Len))))</a>
<a id="7442" class="Comment">--    (cong (bimap (λ x → x) inr)</a>
<a id="7476" class="Comment">--     (cong (bimap (λ x → x) inl)</a>
<a id="7511" class="Comment">--      (cong (bimap (λ x → x) (λ section → a , section))</a>
<a id="7569" class="Comment">--       (cong (bimap (λ x → x) (λ section → n , section))</a>
<a id="7628" class="Comment">--        (trans</a>
<a id="7645" class="Comment">--         (cong (λ p → a ∷ fst p , fst p , snd p , refl) (to-fromLen l))</a>
<a id="7719" class="Comment">--         refl))))))</a>
<a id="7741" class="Comment">--   refl</a>

<a id="7752" class="Comment">--instance to-fromLenC = genIndC to-fromLenP to-fromLen</a>
<a id="7808" class="Comment">--</a>
<a id="7811" class="Comment">----------</a>
<a id="7822" class="Comment">---- All predicate</a>
<a id="7841" class="Comment">--</a>
<a id="7844" class="Comment">--private</a>
<a id="7854" class="Comment">--  ListPOD : DataOD (findDataD (quote List))</a>
<a id="7900" class="Comment">--  ListPOD = PredOD (quote List)</a>
<a id="7934" class="Comment">--</a>
<a id="7937" class="Comment">--instance ListPO = ⌈ ListPOD ⌉ᵈ</a>
<a id="7970" class="Comment">--</a>
<a id="7973" class="Comment">-- unquoteDecl data ListP constructor c0 c1 = defineByDataD ⌊ ListPOD ⌋ᵈ ListP (c0 ∷ c1 ∷ [])</a>
<a id="8067" class="Keyword">data</a> <a id="ListP"></a><a id="8072" href="Examples.WithoutMacros.List.html#8072" class="Datatype">ListP</a> <a id="8078" class="Symbol">{</a><a id="8079" href="Examples.WithoutMacros.List.html#8079" class="Bound">ℓ&#39;</a> <a id="8082" href="Examples.WithoutMacros.List.html#8082" class="Bound">ℓ</a><a id="8083" class="Symbol">}</a> <a id="8085" class="Symbol">{</a><a id="8086" href="Examples.WithoutMacros.List.html#8086" class="Bound">A</a> <a id="8088" class="Symbol">:</a> <a id="8090" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="8094" href="Examples.WithoutMacros.List.html#8082" class="Bound">ℓ</a><a id="8095" class="Symbol">}</a> <a id="8097" class="Symbol">(</a><a id="8098" href="Examples.WithoutMacros.List.html#8098" class="Bound">P</a> <a id="8100" class="Symbol">:</a> <a id="8102" href="Examples.WithoutMacros.List.html#8086" class="Bound">A</a> <a id="8104" class="Symbol">→</a> <a id="8106" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="8110" href="Examples.WithoutMacros.List.html#8079" class="Bound">ℓ&#39;</a><a id="8112" class="Symbol">)</a> <a id="8114" class="Symbol">:</a> <a id="8116" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="8120" class="Symbol">(</a><a id="8121" href="Examples.WithoutMacros.List.html#8082" class="Bound">ℓ</a> <a id="8123" href="Agda.Primitive.html#795" class="Primitive Operator">⊔</a> <a id="8125" href="Examples.WithoutMacros.List.html#8079" class="Bound">ℓ&#39;</a><a id="8127" class="Symbol">)</a> <a id="8129" class="Keyword">where</a>
  <a id="ListP.[]"></a><a id="8137" href="Examples.WithoutMacros.List.html#8137" class="InductiveConstructor">[]</a>      <a id="8145" class="Symbol">:</a> <a id="8147" href="Examples.WithoutMacros.List.html#8072" class="Datatype">ListP</a> <a id="8153" href="Examples.WithoutMacros.List.html#8098" class="Bound">P</a>
  <a id="ListP.⟨_,_⟩∷_"></a><a id="8157" href="Examples.WithoutMacros.List.html#8157" class="InductiveConstructor Operator">⟨_,_⟩∷_</a> <a id="8165" class="Symbol">:</a> <a id="8167" class="Symbol">(</a><a id="8168" href="Examples.WithoutMacros.List.html#8168" class="Bound">a</a> <a id="8170" class="Symbol">:</a> <a id="8172" href="Examples.WithoutMacros.List.html#8086" class="Bound">A</a><a id="8173" class="Symbol">)</a> <a id="8175" class="Symbol">→</a> <a id="8177" href="Examples.WithoutMacros.List.html#8098" class="Bound">P</a> <a id="8179" href="Examples.WithoutMacros.List.html#8168" class="Bound">a</a> <a id="8181" class="Symbol">→</a> <a id="8183" href="Examples.WithoutMacros.List.html#8072" class="Datatype">ListP</a> <a id="8189" href="Examples.WithoutMacros.List.html#8098" class="Bound">P</a> <a id="8191" class="Symbol">→</a> <a id="8193" href="Examples.WithoutMacros.List.html#8072" class="Datatype">ListP</a> <a id="8199" href="Examples.WithoutMacros.List.html#8098" class="Bound">P</a>

<a id="8202" class="Comment">--instance</a>
<a id="8213" class="Comment">--</a>
<a id="8216" class="Comment">--  ListPC : Named (quote ListP) _</a>
<a id="8251" class="Comment">--  unNamed ListPC = genDataC ⌊ ListPOD ⌋ᵈ (genDataT ⌊ ListPOD ⌋ᵈ ListP)</a>
<a id="8324" class="Comment">--</a>
<a id="8327" class="Comment">--  ListPFin : Finitary ⌊ ListPOD ⌋ᵈ</a>
<a id="8364" class="Comment">--  ListPFin = [] ∷ (tt ∷ tt ∷ refl ∷ []) ∷ []</a>
<a id="8411" class="Comment">--</a>
<a id="8414" class="Comment">--private</a>
<a id="8424" class="Comment">--  fromListPP : FoldP</a>
<a id="8447" class="Comment">--  fromListPP = forget (quote ListP) (quote List)</a>
<a id="8498" class="Comment">--</a>
<a id="8501" class="Comment">-- unquoteDecl fromListP = defineFold fromListPP fromListP</a>
<a id="fromListP"></a><a id="8560" href="Examples.WithoutMacros.List.html#8560" class="Function">fromListP</a> <a id="8570" class="Symbol">:</a> <a id="8572" class="Symbol">∀</a> <a id="8574" class="Symbol">{</a><a id="8575" href="Examples.WithoutMacros.List.html#8575" class="Bound">ℓ&#39;</a> <a id="8578" href="Examples.WithoutMacros.List.html#8578" class="Bound">ℓ</a><a id="8579" class="Symbol">}</a> <a id="8581" class="Symbol">{</a><a id="8582" href="Examples.WithoutMacros.List.html#8582" class="Bound">A</a> <a id="8584" class="Symbol">:</a> <a id="8586" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="8590" href="Examples.WithoutMacros.List.html#8578" class="Bound">ℓ</a><a id="8591" class="Symbol">}</a> <a id="8593" class="Symbol">{</a><a id="8594" href="Examples.WithoutMacros.List.html#8594" class="Bound">P</a> <a id="8596" class="Symbol">:</a> <a id="8598" href="Examples.WithoutMacros.List.html#8582" class="Bound">A</a> <a id="8600" class="Symbol">→</a> <a id="8602" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="8606" href="Examples.WithoutMacros.List.html#8575" class="Bound">ℓ&#39;</a><a id="8608" class="Symbol">}</a> <a id="8610" class="Symbol">→</a> <a id="8612" href="Examples.WithoutMacros.List.html#8072" class="Datatype">ListP</a> <a id="8618" href="Examples.WithoutMacros.List.html#8594" class="Bound">P</a> <a id="8620" class="Symbol">→</a> <a id="8622" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="8627" href="Examples.WithoutMacros.List.html#8582" class="Bound">A</a>
<a id="8629" href="Examples.WithoutMacros.List.html#8560" class="Function">fromListP</a> <a id="8639" href="Examples.WithoutMacros.List.html#8137" class="InductiveConstructor">[]</a>               <a id="8656" class="Symbol">=</a> <a id="8658" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
<a id="8661" href="Examples.WithoutMacros.List.html#8560" class="Function">fromListP</a> <a id="8671" class="Symbol">(</a><a id="8672" href="Examples.WithoutMacros.List.html#8157" class="InductiveConstructor Operator">⟨</a> <a id="8674" href="Examples.WithoutMacros.List.html#8674" class="Bound">a</a> <a id="8676" href="Examples.WithoutMacros.List.html#8157" class="InductiveConstructor Operator">,</a> <a id="8678" href="Examples.WithoutMacros.List.html#8678" class="Bound">p</a> <a id="8680" href="Examples.WithoutMacros.List.html#8157" class="InductiveConstructor Operator">⟩∷</a> <a id="8683" href="Examples.WithoutMacros.List.html#8683" class="Bound">aps</a><a id="8686" class="Symbol">)</a> <a id="8688" class="Symbol">=</a> <a id="8690" href="Examples.WithoutMacros.List.html#8674" class="Bound">a</a> <a id="8692" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="8694" href="Examples.WithoutMacros.List.html#8560" class="Function">fromListP</a> <a id="8704" href="Examples.WithoutMacros.List.html#8683" class="Bound">aps</a>

<a id="8709" class="Comment">--instance fromListPC = genFoldC fromListPP fromListP</a>
<a id="8763" class="Comment">--</a>
<a id="8766" class="Comment">--private</a>
<a id="8776" class="Comment">--  ListAllOD : DataOD ⌊ ListPOD ⌋ᵈ</a>
<a id="8812" class="Comment">--  ListAllOD = AllOD (quote List)</a>
<a id="8847" class="Comment">--</a>
<a id="8850" class="Comment">--instance ListAllO = ⌈ ListAllOD ⌉ᵈ</a>
<a id="8887" class="Comment">--</a>
<a id="8890" class="Comment">-- unquoteDecl data ListAll constructor c0 c1 = defineByDataD ⌊ ListAllOD ⌋ᵈ ListAll (c0 ∷ c1 ∷ [])</a>
<a id="8990" class="Keyword">data</a> <a id="ListAll"></a><a id="8995" href="Examples.WithoutMacros.List.html#8995" class="Datatype">ListAll</a> <a id="9003" class="Symbol">{</a><a id="9004" href="Examples.WithoutMacros.List.html#9004" class="Bound">ℓ&#39;</a> <a id="9007" href="Examples.WithoutMacros.List.html#9007" class="Bound">ℓ</a><a id="9008" class="Symbol">}</a> <a id="9010" class="Symbol">{</a><a id="9011" href="Examples.WithoutMacros.List.html#9011" class="Bound">A</a> <a id="9013" class="Symbol">:</a> <a id="9015" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="9019" href="Examples.WithoutMacros.List.html#9007" class="Bound">ℓ</a><a id="9020" class="Symbol">}</a> <a id="9022" class="Symbol">(</a><a id="9023" href="Examples.WithoutMacros.List.html#9023" class="Bound">P</a> <a id="9025" class="Symbol">:</a> <a id="9027" href="Examples.WithoutMacros.List.html#9011" class="Bound">A</a> <a id="9029" class="Symbol">→</a> <a id="9031" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="9035" href="Examples.WithoutMacros.List.html#9004" class="Bound">ℓ&#39;</a><a id="9037" class="Symbol">)</a> <a id="9039" class="Symbol">:</a> <a id="9041" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="9046" href="Examples.WithoutMacros.List.html#9011" class="Bound">A</a> <a id="9048" class="Symbol">→</a> <a id="9050" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="9054" class="Symbol">(</a><a id="9055" href="Examples.WithoutMacros.List.html#9007" class="Bound">ℓ</a> <a id="9057" href="Agda.Primitive.html#795" class="Primitive Operator">⊔</a> <a id="9059" href="Examples.WithoutMacros.List.html#9004" class="Bound">ℓ&#39;</a><a id="9061" class="Symbol">)</a> <a id="9063" class="Keyword">where</a>
  <a id="ListAll.[]"></a><a id="9071" href="Examples.WithoutMacros.List.html#9071" class="InductiveConstructor">[]</a>  <a id="9075" class="Symbol">:</a> <a id="9077" href="Examples.WithoutMacros.List.html#8995" class="Datatype">ListAll</a> <a id="9085" href="Examples.WithoutMacros.List.html#9023" class="Bound">P</a> <a id="9087" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
  <a id="ListAll._∷_"></a><a id="9092" href="Examples.WithoutMacros.List.html#9092" class="InductiveConstructor Operator">_∷_</a> <a id="9096" class="Symbol">:</a> <a id="9098" class="Symbol">{</a><a id="9099" href="Examples.WithoutMacros.List.html#9099" class="Bound">a</a> <a id="9101" class="Symbol">:</a> <a id="9103" href="Examples.WithoutMacros.List.html#9011" class="Bound">A</a><a id="9104" class="Symbol">}</a> <a id="9106" class="Symbol">→</a> <a id="9108" href="Examples.WithoutMacros.List.html#9023" class="Bound">P</a> <a id="9110" href="Examples.WithoutMacros.List.html#9099" class="Bound">a</a> <a id="9112" class="Symbol">→</a> <a id="9114" class="Symbol">{</a><a id="9115" href="Examples.WithoutMacros.List.html#9115" class="Bound">as</a> <a id="9118" class="Symbol">:</a> <a id="9120" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="9125" href="Examples.WithoutMacros.List.html#9011" class="Bound">A</a><a id="9126" class="Symbol">}</a> <a id="9128" class="Symbol">→</a> <a id="9130" href="Examples.WithoutMacros.List.html#8995" class="Datatype">ListAll</a> <a id="9138" href="Examples.WithoutMacros.List.html#9023" class="Bound">P</a> <a id="9140" href="Examples.WithoutMacros.List.html#9115" class="Bound">as</a> <a id="9143" class="Symbol">→</a> <a id="9145" href="Examples.WithoutMacros.List.html#8995" class="Datatype">ListAll</a> <a id="9153" href="Examples.WithoutMacros.List.html#9023" class="Bound">P</a> <a id="9155" class="Symbol">(</a><a id="9156" href="Examples.WithoutMacros.List.html#9099" class="Bound">a</a> <a id="9158" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="9160" href="Examples.WithoutMacros.List.html#9115" class="Bound">as</a><a id="9162" class="Symbol">)</a>

<a id="9165" class="Comment">--instance</a>
<a id="9176" class="Comment">--  ListAllC : Named (quote ListAll) _</a>
<a id="9215" class="Comment">--  unNamed ListAllC = genDataC ⌊ ListAllOD ⌋ᵈ ListAllT</a>
<a id="9271" class="Comment">--    where ListAllT = genDataT ⌊ ListAllOD ⌋ᵈ ListAll</a>
<a id="9326" class="Comment">--</a>
<a id="9329" class="Comment">--private</a>
<a id="9339" class="Comment">--  fromAllP : FoldP</a>
<a id="9360" class="Comment">--  fromAllP = forget (quote ListAll) (quote ListP)</a>
<a id="9412" class="Comment">--</a>
<a id="9415" class="Comment">-- unquoteDecl fromAll = defineFold fromAllP fromAll</a>
<a id="fromAll"></a><a id="9468" href="Examples.WithoutMacros.List.html#9468" class="Function">fromAll</a> <a id="9476" class="Symbol">:</a> <a id="9478" class="Symbol">∀</a> <a id="9480" class="Symbol">{</a><a id="9481" href="Examples.WithoutMacros.List.html#9481" class="Bound">ℓ&#39;</a> <a id="9484" href="Examples.WithoutMacros.List.html#9484" class="Bound">ℓ</a><a id="9485" class="Symbol">}</a> <a id="9487" class="Symbol">{</a><a id="9488" href="Examples.WithoutMacros.List.html#9488" class="Bound">A</a> <a id="9490" class="Symbol">:</a> <a id="9492" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="9496" href="Examples.WithoutMacros.List.html#9484" class="Bound">ℓ</a><a id="9497" class="Symbol">}</a> <a id="9499" class="Symbol">{</a><a id="9500" href="Examples.WithoutMacros.List.html#9500" class="Bound">P</a> <a id="9502" class="Symbol">:</a> <a id="9504" href="Examples.WithoutMacros.List.html#9488" class="Bound">A</a> <a id="9506" class="Symbol">→</a> <a id="9508" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="9512" href="Examples.WithoutMacros.List.html#9481" class="Bound">ℓ&#39;</a><a id="9514" class="Symbol">}</a> <a id="9516" class="Symbol">{</a><a id="9517" href="Examples.WithoutMacros.List.html#9517" class="Bound">as</a> <a id="9520" class="Symbol">:</a> <a id="9522" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="9527" href="Examples.WithoutMacros.List.html#9488" class="Bound">A</a><a id="9528" class="Symbol">}</a> <a id="9530" class="Symbol">→</a> <a id="9532" href="Examples.WithoutMacros.List.html#8995" class="Datatype">ListAll</a> <a id="9540" href="Examples.WithoutMacros.List.html#9500" class="Bound">P</a> <a id="9542" href="Examples.WithoutMacros.List.html#9517" class="Bound">as</a> <a id="9545" class="Symbol">→</a> <a id="9547" href="Examples.WithoutMacros.List.html#8072" class="Datatype">ListP</a> <a id="9553" href="Examples.WithoutMacros.List.html#9500" class="Bound">P</a>
<a id="9555" href="Examples.WithoutMacros.List.html#9468" class="Function">fromAll</a> <a id="9563" href="Examples.WithoutMacros.List.html#9071" class="InductiveConstructor">[]</a>       <a id="9572" class="Symbol">=</a> <a id="9574" href="Examples.WithoutMacros.List.html#8137" class="InductiveConstructor">[]</a>
<a id="9577" href="Examples.WithoutMacros.List.html#9468" class="Function">fromAll</a> <a id="9585" class="Symbol">(</a><a id="9586" href="Examples.WithoutMacros.List.html#9586" class="Bound">p</a> <a id="9588" href="Examples.WithoutMacros.List.html#9092" class="InductiveConstructor Operator">∷</a> <a id="9590" href="Examples.WithoutMacros.List.html#9590" class="Bound">ps</a><a id="9592" class="Symbol">)</a> <a id="9594" class="Symbol">=</a> <a id="9596" href="Examples.WithoutMacros.List.html#8157" class="InductiveConstructor Operator">⟨</a> <a id="9598" class="Symbol">_</a> <a id="9600" href="Examples.WithoutMacros.List.html#8157" class="InductiveConstructor Operator">,</a> <a id="9602" href="Examples.WithoutMacros.List.html#9586" class="Bound">p</a> <a id="9604" href="Examples.WithoutMacros.List.html#8157" class="InductiveConstructor Operator">⟩∷</a> <a id="9607" href="Examples.WithoutMacros.List.html#9468" class="Function">fromAll</a> <a id="9615" href="Examples.WithoutMacros.List.html#9590" class="Bound">ps</a>

<a id="9619" class="Comment">--instance fromAllC = genFoldC fromAllP fromAll</a>
<a id="9667" class="Comment">--</a>
<a id="9670" class="Comment">--private</a>
<a id="9680" class="Comment">--  toAllP : IndP</a>
<a id="9698" class="Comment">--  toAllP = remember (quote ListAll)</a>
<a id="9736" class="Comment">--</a>
<a id="9739" class="Comment">-- unquoteDecl toAll = defineInd toAllP toAll</a>
<a id="toAll"></a><a id="9785" href="Examples.WithoutMacros.List.html#9785" class="Function">toAll</a> <a id="9791" class="Symbol">:</a> <a id="9793" class="Symbol">∀</a> <a id="9795" class="Symbol">{</a><a id="9796" href="Examples.WithoutMacros.List.html#9796" class="Bound">ℓ&#39;</a> <a id="9799" href="Examples.WithoutMacros.List.html#9799" class="Bound">ℓ</a><a id="9800" class="Symbol">}</a> <a id="9802" class="Symbol">{</a><a id="9803" href="Examples.WithoutMacros.List.html#9803" class="Bound">A</a> <a id="9805" class="Symbol">:</a> <a id="9807" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="9811" href="Examples.WithoutMacros.List.html#9799" class="Bound">ℓ</a><a id="9812" class="Symbol">}</a> <a id="9814" class="Symbol">{</a><a id="9815" href="Examples.WithoutMacros.List.html#9815" class="Bound">P</a> <a id="9817" class="Symbol">:</a> <a id="9819" href="Examples.WithoutMacros.List.html#9803" class="Bound">A</a> <a id="9821" class="Symbol">→</a> <a id="9823" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="9827" href="Examples.WithoutMacros.List.html#9796" class="Bound">ℓ&#39;</a><a id="9829" class="Symbol">}</a> <a id="9831" class="Symbol">(</a><a id="9832" href="Examples.WithoutMacros.List.html#9832" class="Bound">aps</a> <a id="9836" class="Symbol">:</a> <a id="9838" href="Examples.WithoutMacros.List.html#8072" class="Datatype">ListP</a> <a id="9844" href="Examples.WithoutMacros.List.html#9815" class="Bound">P</a><a id="9845" class="Symbol">)</a> <a id="9847" class="Symbol">→</a> <a id="9849" href="Examples.WithoutMacros.List.html#8995" class="Datatype">ListAll</a> <a id="9857" href="Examples.WithoutMacros.List.html#9815" class="Bound">P</a> <a id="9859" class="Symbol">(</a><a id="9860" href="Examples.WithoutMacros.List.html#8560" class="Function">fromListP</a> <a id="9870" href="Examples.WithoutMacros.List.html#9832" class="Bound">aps</a><a id="9873" class="Symbol">)</a>
<a id="9875" href="Examples.WithoutMacros.List.html#9785" class="Function">toAll</a> <a id="9881" href="Examples.WithoutMacros.List.html#8137" class="InductiveConstructor">[]</a>               <a id="9898" class="Symbol">=</a> <a id="9900" href="Examples.WithoutMacros.List.html#9071" class="InductiveConstructor">[]</a>
<a id="9903" href="Examples.WithoutMacros.List.html#9785" class="Function">toAll</a> <a id="9909" class="Symbol">(</a><a id="9910" href="Examples.WithoutMacros.List.html#8157" class="InductiveConstructor Operator">⟨</a> <a id="9912" href="Examples.WithoutMacros.List.html#9912" class="Bound">a</a> <a id="9914" href="Examples.WithoutMacros.List.html#8157" class="InductiveConstructor Operator">,</a> <a id="9916" href="Examples.WithoutMacros.List.html#9916" class="Bound">p</a> <a id="9918" href="Examples.WithoutMacros.List.html#8157" class="InductiveConstructor Operator">⟩∷</a> <a id="9921" href="Examples.WithoutMacros.List.html#9921" class="Bound">aps</a><a id="9924" class="Symbol">)</a> <a id="9926" class="Symbol">=</a> <a id="9928" href="Examples.WithoutMacros.List.html#9916" class="Bound">p</a> <a id="9930" href="Examples.WithoutMacros.List.html#9092" class="InductiveConstructor Operator">∷</a> <a id="9932" href="Examples.WithoutMacros.List.html#9785" class="Function">toAll</a> <a id="9938" href="Examples.WithoutMacros.List.html#9921" class="Bound">aps</a>

<a id="9943" class="Comment">--instance toAllC = genIndC toAllP toAll</a>
<a id="9984" class="Comment">--</a>
<a id="9987" class="Comment">--private</a>
<a id="9997" class="Comment">--  from-toAllP : IndP</a>
<a id="10020" class="Comment">--  from-toAllP = forget-remember-inv (quote ListAll) (quote ListP) (inl it)</a>
<a id="10097" class="Comment">--</a>
<a id="10100" class="Comment">-- unquoteDecl from-toAll = defineInd from-toAllP from-toAll</a>
<a id="10161" class="Comment">-- from-toAll : {ℓ&#39; ℓ : Level} {A : Set ℓ} {P : A → Set ℓ&#39;}</a>
<a id="10221" class="Comment">--              (aps : ListP P) → fromAll (toAll aps) ≡ aps</a>
<a id="10281" class="Comment">-- from-toAll [] = refl</a>
<a id="10305" class="Comment">-- from-toAll (⟨ a , p ⟩∷ aps) = cong (⟨_,_⟩∷_ a p) (from-toAll aps)</a>

<a id="10375" class="Comment">--instance from-toAllC = genIndC from-toAllP from-toAll</a>
<a id="10431" class="Comment">--</a>
<a id="10434" class="Comment">--private</a>
<a id="10444" class="Comment">--  to-fromAllP : IndP</a>
<a id="10467" class="Comment">--  to-fromAllP = remember-forget-inv (quote ListAll) (quote ListP) (inl it)</a>
<a id="10544" class="Comment">--</a>
<a id="10547" class="Comment">---- unquoteDecl to-fromAll = defineInd to-fromAllP to-fromAll</a>
<a id="10610" class="Comment">--to-fromAll : {ℓ&#39; ℓ : Level} {A : Set ℓ} {P : A → Set ℓ&#39;}</a>
<a id="10669" class="Comment">--             {as : List A} (all : ListAll P as)</a>
<a id="10719" class="Comment">--           → (fromListP (fromAll all) , toAll (fromAll all))</a>
<a id="10782" class="Comment">--           ≡ ((as , all) ⦂ Σ (List A) (ListAll P))</a>
<a id="10835" class="Comment">--to-fromAll [] = refl</a>
<a id="10858" class="Comment">--to-fromAll (_∷_ {a = a} p all) =</a>
<a id="10893" class="Comment">--  trans</a>
<a id="10903" class="Comment">--   (cong</a>
<a id="10914" class="Comment">--    (bimap (λ x₂ → x₂) (DataC.toN (findDataC (quote ListAll))))</a>
<a id="10980" class="Comment">--    (cong (bimap (λ x₂ → x₂) inr)</a>
<a id="11016" class="Comment">--     (cong (bimap (λ x₂ → x₂) inl)</a>
<a id="11053" class="Comment">--      (cong (bimap (λ x₂ → x₂) (λ section → a , section))</a>
<a id="11113" class="Comment">--       (cong (bimap (λ x₂ → x₂) (λ section → p , section))</a>
<a id="11174" class="Comment">--        (trans</a>
<a id="11191" class="Comment">--         (cong (λ p₁ → a ∷ fst p₁ , fst p₁ , snd p₁ , refl) (to-fromAll all))</a>
<a id="11271" class="Comment">--         refl))))))</a>
<a id="11293" class="Comment">--   refl</a>
<a id="11303" class="Comment">--</a>
<a id="11306" class="Comment">--instance to-fromAllC = genIndC to-fromAllP to-fromAll</a>
<a id="11362" class="Comment">--</a>
<a id="11365" class="Comment">----------</a>
<a id="11376" class="Comment">---- Any predicate</a>
<a id="11395" class="Comment">--</a>
<a id="11398" class="Comment">--private</a>
<a id="11408" class="Comment">--  ListAnyOD : DataOD (findDataD (quote ℕ))</a>
<a id="11453" class="Comment">--  ListAnyOD = AnyOD (quote List)</a>
<a id="11488" class="Comment">--</a>
<a id="11491" class="Comment">--instance ListAnyO = ⌈ ListAnyOD ⌉ᵈ</a>
<a id="11528" class="Comment">--</a>
<a id="11531" class="Comment">-- unquoteDecl data ListAny constructor c0 c1 = defineByDataD ⌊ ListAnyOD ⌋ᵈ ListAny (c0 ∷ c1 ∷ [])</a>
<a id="11631" class="Keyword">data</a> <a id="ListAny"></a><a id="11636" href="Examples.WithoutMacros.List.html#11636" class="Datatype">ListAny</a> <a id="11644" class="Symbol">{</a><a id="11645" href="Examples.WithoutMacros.List.html#11645" class="Bound">ℓ&#39;</a> <a id="11648" href="Examples.WithoutMacros.List.html#11648" class="Bound">ℓ</a><a id="11649" class="Symbol">}</a> <a id="11651" class="Symbol">{</a><a id="11652" href="Examples.WithoutMacros.List.html#11652" class="Bound">A</a> <a id="11654" class="Symbol">:</a> <a id="11656" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="11660" href="Examples.WithoutMacros.List.html#11648" class="Bound">ℓ</a><a id="11661" class="Symbol">}</a> <a id="11663" class="Symbol">(</a><a id="11664" href="Examples.WithoutMacros.List.html#11664" class="Bound">P</a> <a id="11666" class="Symbol">:</a> <a id="11668" href="Examples.WithoutMacros.List.html#11652" class="Bound">A</a> <a id="11670" class="Symbol">→</a> <a id="11672" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="11676" href="Examples.WithoutMacros.List.html#11645" class="Bound">ℓ&#39;</a><a id="11678" class="Symbol">)</a> <a id="11680" class="Symbol">:</a> <a id="11682" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="11687" href="Examples.WithoutMacros.List.html#11652" class="Bound">A</a> <a id="11689" class="Symbol">→</a> <a id="11691" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="11695" class="Symbol">(</a><a id="11696" href="Examples.WithoutMacros.List.html#11648" class="Bound">ℓ</a> <a id="11698" href="Agda.Primitive.html#795" class="Primitive Operator">⊔</a> <a id="11700" href="Examples.WithoutMacros.List.html#11645" class="Bound">ℓ&#39;</a><a id="11702" class="Symbol">)</a> <a id="11704" class="Keyword">where</a>
  <a id="ListAny.here"></a><a id="11712" href="Examples.WithoutMacros.List.html#11712" class="InductiveConstructor">here</a>  <a id="11718" class="Symbol">:</a> <a id="11720" class="Symbol">∀</a> <a id="11722" class="Symbol">{</a><a id="11723" href="Examples.WithoutMacros.List.html#11723" class="Bound">a</a> <a id="11725" href="Examples.WithoutMacros.List.html#11725" class="Bound">as</a><a id="11727" class="Symbol">}</a> <a id="11729" class="Symbol">→</a> <a id="11731" href="Examples.WithoutMacros.List.html#11664" class="Bound">P</a> <a id="11733" href="Examples.WithoutMacros.List.html#11723" class="Bound">a</a> <a id="11735" class="Symbol">→</a> <a id="11737" href="Examples.WithoutMacros.List.html#11636" class="Datatype">ListAny</a> <a id="11745" href="Examples.WithoutMacros.List.html#11664" class="Bound">P</a> <a id="11747" class="Symbol">(</a><a id="11748" href="Examples.WithoutMacros.List.html#11723" class="Bound">a</a> <a id="11750" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="11752" href="Examples.WithoutMacros.List.html#11725" class="Bound">as</a><a id="11754" class="Symbol">)</a>
  <a id="ListAny.there"></a><a id="11758" href="Examples.WithoutMacros.List.html#11758" class="InductiveConstructor">there</a> <a id="11764" class="Symbol">:</a> <a id="11766" class="Symbol">∀</a> <a id="11768" class="Symbol">{</a><a id="11769" href="Examples.WithoutMacros.List.html#11769" class="Bound">a</a> <a id="11771" href="Examples.WithoutMacros.List.html#11771" class="Bound">as</a><a id="11773" class="Symbol">}</a> <a id="11775" class="Symbol">→</a> <a id="11777" href="Examples.WithoutMacros.List.html#11636" class="Datatype">ListAny</a> <a id="11785" href="Examples.WithoutMacros.List.html#11664" class="Bound">P</a> <a id="11787" href="Examples.WithoutMacros.List.html#11771" class="Bound">as</a> <a id="11790" class="Symbol">→</a> <a id="11792" href="Examples.WithoutMacros.List.html#11636" class="Datatype">ListAny</a> <a id="11800" href="Examples.WithoutMacros.List.html#11664" class="Bound">P</a> <a id="11802" class="Symbol">(</a><a id="11803" href="Examples.WithoutMacros.List.html#11769" class="Bound">a</a> <a id="11805" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="11807" href="Examples.WithoutMacros.List.html#11771" class="Bound">as</a><a id="11809" class="Symbol">)</a>

<a id="11812" class="Comment">--instance</a>
<a id="11823" class="Comment">--  ListAnyC : Named (quote ListAny) _</a>
<a id="11862" class="Comment">--  unNamed ListAnyC = genDataC ⌊ ListAnyOD ⌋ᵈ ListAnyT</a>
<a id="11918" class="Comment">--    where ListAnyT = genDataT ⌊ ListAnyOD ⌋ᵈ ListAny</a>
<a id="11973" class="Comment">--</a>
<a id="_∋_"></a><a id="11976" href="Examples.WithoutMacros.List.html#11976" class="Function Operator">_∋_</a> <a id="11980" class="Symbol">:</a> <a id="11982" class="Symbol">{</a><a id="11983" href="Examples.WithoutMacros.List.html#11983" class="Bound">A</a> <a id="11985" class="Symbol">:</a> <a id="11987" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="11991" href="Prelude.Level.html#316" class="Generalizable">ℓ</a><a id="11992" class="Symbol">}</a> <a id="11994" class="Symbol">→</a> <a id="11996" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="12001" href="Examples.WithoutMacros.List.html#11983" class="Bound">A</a> <a id="12003" class="Symbol">→</a> <a id="12005" href="Examples.WithoutMacros.List.html#11983" class="Bound">A</a> <a id="12007" class="Symbol">→</a> <a id="12009" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="12013" href="Prelude.Level.html#316" class="Generalizable">ℓ</a>
<a id="12015" href="Examples.WithoutMacros.List.html#12015" class="Bound">xs</a> <a id="12018" href="Examples.WithoutMacros.List.html#11976" class="Function Operator">∋</a> <a id="12020" href="Examples.WithoutMacros.List.html#12020" class="Bound">x</a> <a id="12022" class="Symbol">=</a> <a id="12024" href="Examples.WithoutMacros.List.html#11636" class="Datatype">ListAny</a> <a id="12032" class="Symbol">(</a><a id="12033" href="Examples.WithoutMacros.List.html#12020" class="Bound">x</a> <a id="12035" href="Agda.Builtin.Equality.html#124" class="Datatype Operator">≡_</a><a id="12037" class="Symbol">)</a> <a id="12039" href="Examples.WithoutMacros.List.html#12015" class="Bound">xs</a>

<a id="12043" class="Comment">--private</a>
<a id="12053" class="Comment">--  toℕP : FoldP</a>
<a id="12070" class="Comment">--  toℕP = forget (quote ListAny) (quote ℕ)</a>
<a id="12114" class="Comment">--</a>
<a id="12117" class="Comment">-- unquoteDecl toℕ = defineFold toℕP toℕ</a>
<a id="toℕ"></a><a id="12158" href="Examples.WithoutMacros.List.html#12158" class="Function">toℕ</a> <a id="12162" class="Symbol">:</a> <a id="12164" class="Symbol">∀</a> <a id="12166" class="Symbol">{</a><a id="12167" href="Examples.WithoutMacros.List.html#12167" class="Bound">ℓ&#39;</a> <a id="12170" href="Examples.WithoutMacros.List.html#12170" class="Bound">ℓ</a><a id="12171" class="Symbol">}</a> <a id="12173" class="Symbol">{</a><a id="12174" href="Examples.WithoutMacros.List.html#12174" class="Bound">A</a> <a id="12176" class="Symbol">:</a> <a id="12178" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="12182" href="Examples.WithoutMacros.List.html#12170" class="Bound">ℓ</a><a id="12183" class="Symbol">}</a> <a id="12185" class="Symbol">{</a><a id="12186" href="Examples.WithoutMacros.List.html#12186" class="Bound">P</a> <a id="12188" class="Symbol">:</a> <a id="12190" href="Examples.WithoutMacros.List.html#12174" class="Bound">A</a> <a id="12192" class="Symbol">→</a> <a id="12194" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="12198" href="Examples.WithoutMacros.List.html#12167" class="Bound">ℓ&#39;</a><a id="12200" class="Symbol">}</a> <a id="12202" class="Symbol">{</a><a id="12203" href="Examples.WithoutMacros.List.html#12203" class="Bound">as</a> <a id="12206" class="Symbol">:</a> <a id="12208" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="12213" href="Examples.WithoutMacros.List.html#12174" class="Bound">A</a><a id="12214" class="Symbol">}</a> <a id="12216" class="Symbol">→</a> <a id="12218" href="Examples.WithoutMacros.List.html#11636" class="Datatype">ListAny</a> <a id="12226" href="Examples.WithoutMacros.List.html#12186" class="Bound">P</a> <a id="12228" href="Examples.WithoutMacros.List.html#12203" class="Bound">as</a> <a id="12231" class="Symbol">→</a> <a id="12233" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a>
<a id="12235" href="Examples.WithoutMacros.List.html#12158" class="Function">toℕ</a> <a id="12239" class="Symbol">(</a><a id="12240" href="Examples.WithoutMacros.List.html#11712" class="InductiveConstructor">here</a>  <a id="12246" href="Examples.WithoutMacros.List.html#12246" class="Bound">p</a><a id="12247" class="Symbol">)</a> <a id="12249" class="Symbol">=</a> <a id="12251" class="Number">0</a>
<a id="12253" href="Examples.WithoutMacros.List.html#12158" class="Function">toℕ</a> <a id="12257" class="Symbol">(</a><a id="12258" href="Examples.WithoutMacros.List.html#11758" class="InductiveConstructor">there</a> <a id="12264" href="Examples.WithoutMacros.List.html#12264" class="Bound">i</a><a id="12265" class="Symbol">)</a> <a id="12267" class="Symbol">=</a> <a id="12269" href="Agda.Builtin.Nat.html#208" class="InductiveConstructor">suc</a> <a id="12273" class="Symbol">(</a><a id="12274" href="Examples.WithoutMacros.List.html#12158" class="Function">toℕ</a> <a id="12278" href="Examples.WithoutMacros.List.html#12264" class="Bound">i</a><a id="12279" class="Symbol">)</a>

<a id="12282" class="Comment">--instance toℕC = genFoldC toℕP toℕ</a>
</pre></body></html>