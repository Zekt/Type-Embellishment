<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Examples.WithMacros.Acc</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--with-K</a> <a id="29" class="Symbol">#-}</a>

<a id="34" class="Keyword">module</a> <a id="41" href="Examples.WithMacros.Acc.html" class="Module">Examples.WithMacros.Acc</a> <a id="65" class="Keyword">where</a>

<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Prelude.html" class="Module">Prelude</a> <a id="92" class="Keyword">hiding</a> <a id="99" class="Symbol">(</a><a id="100" href="Prelude.List.html#5721" class="Function">lookupAny</a><a id="109" class="Symbol">)</a>

<a id="112" class="Keyword">open</a> <a id="117" class="Keyword">import</a> <a id="124" href="Generics.Description.html" class="Module">Generics.Description</a>
<a id="145" class="Keyword">open</a> <a id="150" class="Keyword">import</a> <a id="157" href="Generics.Recursion.html" class="Module">Generics.Recursion</a>
<a id="176" class="Keyword">open</a> <a id="181" class="Keyword">import</a> <a id="188" href="Generics.Reflection.html" class="Module">Generics.Reflection</a>

<a id="209" class="Keyword">open</a> <a id="214" class="Keyword">import</a> <a id="221" href="Generics.RecursionScheme.html" class="Module">Generics.RecursionScheme</a>
<a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="Generics.SimpleContainer.html" class="Module">Generics.SimpleContainer</a>
<a id="283" class="Keyword">open</a> <a id="288" class="Keyword">import</a> <a id="295" href="Generics.SimpleContainer.Any.html" class="Module">Generics.SimpleContainer.Any</a>

<a id="325" class="Keyword">data</a> <a id="Acc"></a><a id="330" href="Examples.WithMacros.Acc.html#330" class="Datatype">Acc</a> <a id="334" class="Symbol">{</a><a id="335" href="Examples.WithMacros.Acc.html#335" class="Bound">A</a> <a id="337" class="Symbol">:</a> <a id="339" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="343" href="Prelude.Level.html#316" class="Generalizable">ℓ</a><a id="344" class="Symbol">}</a> <a id="346" class="Symbol">(</a><a id="347" href="Examples.WithMacros.Acc.html#347" class="Bound">R</a> <a id="349" class="Symbol">:</a> <a id="351" href="Examples.WithMacros.Acc.html#335" class="Bound">A</a> <a id="353" class="Symbol">→</a> <a id="355" href="Examples.WithMacros.Acc.html#335" class="Bound">A</a> <a id="357" class="Symbol">→</a> <a id="359" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="363" href="Prelude.Level.html#318" class="Generalizable">ℓ&#39;</a><a id="365" class="Symbol">)</a> <a id="367" class="Symbol">:</a> <a id="369" href="Examples.WithMacros.Acc.html#335" class="Bound">A</a> <a id="371" class="Symbol">→</a> <a id="373" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="377" class="Symbol">(</a><a id="378" href="Examples.WithMacros.Acc.html#343" class="Bound">ℓ</a> <a id="380" href="Agda.Primitive.html#795" class="Primitive Operator">⊔</a> <a id="382" href="Examples.WithMacros.Acc.html#363" class="Bound">ℓ&#39;</a><a id="384" class="Symbol">)</a> <a id="386" class="Keyword">where</a>
  <a id="Acc.acc"></a><a id="394" href="Examples.WithMacros.Acc.html#394" class="InductiveConstructor">acc</a> <a id="398" class="Symbol">:</a> <a id="400" class="Symbol">{</a><a id="401" href="Examples.WithMacros.Acc.html#401" class="Bound">x</a> <a id="403" class="Symbol">:</a> <a id="405" href="Examples.WithMacros.Acc.html#335" class="Bound">A</a><a id="406" class="Symbol">}</a> <a id="408" class="Symbol">→</a> <a id="410" class="Symbol">((</a><a id="412" href="Examples.WithMacros.Acc.html#412" class="Bound">y</a> <a id="414" class="Symbol">:</a> <a id="416" href="Examples.WithMacros.Acc.html#335" class="Bound">A</a><a id="417" class="Symbol">)</a> <a id="419" class="Symbol">→</a> <a id="421" href="Examples.WithMacros.Acc.html#347" class="Bound">R</a> <a id="423" href="Examples.WithMacros.Acc.html#412" class="Bound">y</a> <a id="425" href="Examples.WithMacros.Acc.html#401" class="Bound">x</a> <a id="427" class="Symbol">→</a> <a id="429" href="Examples.WithMacros.Acc.html#330" class="Datatype">Acc</a> <a id="433" href="Examples.WithMacros.Acc.html#347" class="Bound">R</a> <a id="435" href="Examples.WithMacros.Acc.html#412" class="Bound">y</a><a id="436" class="Symbol">)</a> <a id="438" class="Symbol">→</a> <a id="440" href="Examples.WithMacros.Acc.html#330" class="Datatype">Acc</a> <a id="444" href="Examples.WithMacros.Acc.html#347" class="Bound">R</a> <a id="446" href="Examples.WithMacros.Acc.html#401" class="Bound">x</a>

<a id="449" class="Comment">--------</a>
<a id="458" class="Comment">-- Strong induction as the fold operator on Acc</a>

<a id="507" class="Keyword">instance</a>
  <a id="AccC"></a><a id="518" href="Examples.WithMacros.Acc.html#518" class="Function">AccC</a> <a id="523" class="Symbol">:</a> <a id="525" href="Generics.Recursion.html#674" class="Record">Named</a> <a id="531" class="Symbol">(</a><a id="532" class="Keyword">quote</a> <a id="538" href="Examples.WithMacros.Acc.html#330" class="Datatype">Acc</a><a id="541" class="Symbol">)</a> <a id="543" class="Symbol">_</a>
  <a id="547" href="Generics.Recursion.html#747" class="Field">unNamed</a> <a id="555" href="Examples.WithMacros.Acc.html#518" class="Function">AccC</a> <a id="560" class="Symbol">=</a> <a id="562" href="Generics.Reflection.Connection.html#4151" class="Macro">genDataC</a> <a id="571" href="Examples.WithMacros.Acc.html#606" class="Function">AccD</a> <a id="576" class="Symbol">(</a><a id="577" href="Generics.Reflection.Uncurry.html#3452" class="Macro">genDataT</a> <a id="586" href="Examples.WithMacros.Acc.html#606" class="Function">AccD</a> <a id="591" href="Examples.WithMacros.Acc.html#330" class="Datatype">Acc</a><a id="594" class="Symbol">)</a>
    <a id="600" class="Keyword">where</a> <a id="606" href="Examples.WithMacros.Acc.html#606" class="Function">AccD</a> <a id="611" class="Symbol">=</a> <a id="613" href="Generics.Reflection.Datatype.html#6792" class="Macro">genDataD</a> <a id="622" href="Examples.WithMacros.Acc.html#330" class="Datatype">Acc</a>

<a id="627" class="Keyword">private</a>
  <a id="foldAccP"></a><a id="637" href="Examples.WithMacros.Acc.html#637" class="Function">foldAccP</a> <a id="646" class="Symbol">:</a> <a id="648" href="Generics.Recursion.html#1055" class="Record">FoldP</a>
  <a id="656" href="Examples.WithMacros.Acc.html#637" class="Function">foldAccP</a> <a id="665" class="Symbol">=</a> <a id="667" href="Generics.RecursionScheme.html#1168" class="Function">fold-operator</a> <a id="681" class="Symbol">(</a><a id="682" class="Keyword">quote</a> <a id="688" href="Examples.WithMacros.Acc.html#330" class="Datatype">Acc</a><a id="691" class="Symbol">)</a>

<a id="694" class="Keyword">unquoteDecl</a> <a id="foldAcc"></a><a id="706" href="Examples.WithMacros.Acc.html#706" class="Function">foldAcc</a> <a id="714" class="Symbol">=</a> <a id="716" href="Generics.Reflection.Recursion.html#1320" class="Function">defineFold</a> <a id="727" href="Examples.WithMacros.Acc.html#637" class="Function">foldAccP</a> <a id="736" href="Examples.WithMacros.Acc.html#706" class="Function">foldAcc</a>
<a id="744" class="Comment">--foldAcc :</a>
<a id="756" class="Comment">--  ∀ {ℓ&#39;&#39; ℓ ℓ&#39;} {A : Set ℓ} {R : A → A → Set ℓ&#39;} {P : A → Set ℓ&#39;&#39;}</a>
<a id="824" class="Comment">--  → ((x : A) → ((y : A) → R y x → P y) → P x)</a>
<a id="872" class="Comment">--  → (x : A) → Acc R x → P x</a>
<a id="902" class="Comment">--foldAcc p x (acc accs) = p x (λ y r → foldAcc p y (accs y r))</a>

<a id="967" class="Keyword">instance</a> <a id="foldAccC"></a><a id="976" href="Examples.WithMacros.Acc.html#976" class="Function">foldAccC</a> <a id="985" class="Symbol">=</a> <a id="987" href="Generics.Reflection.Connection.html#4298" class="Macro">genFoldC</a> <a id="996" href="Examples.WithMacros.Acc.html#637" class="Function">foldAccP</a> <a id="1005" href="Examples.WithMacros.Acc.html#706" class="Function">foldAcc</a>

<a id="1014" class="Comment">--------</a>
<a id="1023" class="Comment">-- Descending chains in terms of the Any predicate</a>

<a id="1075" class="Keyword">instance</a>
  <a id="AccS"></a><a id="1086" href="Examples.WithMacros.Acc.html#1086" class="Function">AccS</a> <a id="1091" class="Symbol">:</a> <a id="1093" href="Generics.SimpleContainer.html#2387" class="Function">SCᵈ</a> <a id="1097" class="Symbol">(</a><a id="1098" href="Generics.Recursion.html#962" class="Function">findDataD</a> <a id="1108" class="Symbol">(</a><a id="1109" class="Keyword">quote</a> <a id="1115" href="Examples.WithMacros.Acc.html#330" class="Datatype">Acc</a><a id="1118" class="Symbol">))</a>
  <a id="1123" href="Examples.WithMacros.Acc.html#1086" class="Function">AccS</a> <a id="1128" class="Symbol">=</a> <a id="1130" class="Keyword">record</a>
    <a id="1141" class="Symbol">{</a> <a id="1143" href="Generics.SimpleContainer.html#2234" class="Field">El</a>  <a id="1147" class="Symbol">=</a> <a id="1149" class="Symbol">λ</a> <a id="1151" class="Symbol">(</a><a id="1152" href="Examples.WithMacros.Acc.html#1152" class="Bound">A</a> <a id="1154" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1156" class="Symbol">_)</a> <a id="1159" class="Symbol">→</a> <a id="1161" href="Examples.WithMacros.Acc.html#1152" class="Bound">A</a>
    <a id="1167" class="Symbol">;</a> <a id="1169" href="Generics.SimpleContainer.html#2277" class="Field">pos</a> <a id="1173" class="Symbol">=</a> <a id="1175" class="Symbol">(</a><a id="1176" href="Agda.Builtin.Bool.html#172" class="InductiveConstructor">true</a> <a id="1181" href="Prelude.List.html#5328" class="InductiveConstructor Operator">∷</a> <a id="1183" href="Agda.Builtin.Unit.html#186" class="InductiveConstructor">tt</a> <a id="1186" href="Prelude.List.html#5328" class="InductiveConstructor Operator">∷</a> <a id="1188" href="Prelude.List.html#5311" class="InductiveConstructor">[]</a><a id="1190" class="Symbol">)</a> <a id="1192" href="Prelude.List.html#5328" class="InductiveConstructor Operator">∷</a> <a id="1194" href="Prelude.List.html#5311" class="InductiveConstructor">[]</a>
    <a id="1201" class="Symbol">;</a> <a id="1203" href="Generics.SimpleContainer.html#2313" class="Field">coe</a> <a id="1207" class="Symbol">=</a> <a id="1209" class="Symbol">λ</a> <a id="1211" href="Examples.WithMacros.Acc.html#1211" class="Bound">_</a> <a id="1213" class="Symbol">→</a> <a id="1215" class="Symbol">(</a><a id="1216" href="Prelude.Relation.PropositionalEquality.html#1611" class="InductiveConstructor">refl</a> <a id="1221" href="Prelude.Sigma.html#1463" class="InductiveConstructor Operator">,ωω</a> <a id="1225" class="Symbol">λ</a> <a id="1227" href="Examples.WithMacros.Acc.html#1227" class="Bound">_</a> <a id="1229" class="Symbol">→</a> <a id="1231" href="Prelude.Level.html#547" class="InductiveConstructor">lift</a> <a id="1236" href="Agda.Builtin.Unit.html#186" class="InductiveConstructor">tt</a><a id="1238" class="Symbol">)</a> <a id="1240" href="Prelude.Sigma.html#1463" class="InductiveConstructor Operator">,ωω</a> <a id="1244" href="Prelude.Level.html#547" class="InductiveConstructor">lift</a> <a id="1249" href="Agda.Builtin.Unit.html#186" class="InductiveConstructor">tt</a> <a id="1252" class="Symbol">}</a>

<a id="1255" class="Keyword">private</a>
  <a id="AccAnyD"></a><a id="1265" href="Examples.WithMacros.Acc.html#1265" class="Function">AccAnyD</a> <a id="1273" class="Symbol">:</a> <a id="1275" href="Generics.Description.html#3148" class="Record">DataD</a>
  <a id="1283" href="Examples.WithMacros.Acc.html#1265" class="Function">AccAnyD</a> <a id="1291" class="Symbol">=</a> <a id="1293" href="Generics.SimpleContainer.Any.html#16624" class="Function">AnyD</a> <a id="1298" class="Symbol">(</a><a id="1299" class="Keyword">quote</a> <a id="1305" href="Examples.WithMacros.Acc.html#330" class="Datatype">Acc</a><a id="1308" class="Symbol">)</a>

<a id="1311" class="Keyword">unquoteDecl</a> <a id="1323" class="Keyword">data</a> <a id="AccAny"></a><a id="1328" href="Examples.WithMacros.Acc.html#1328" class="Datatype">AccAny</a> <a id="1335" class="Keyword">constructor</a> <a id="AccAny.here"></a><a id="1347" href="Examples.WithMacros.Acc.html#1347" class="InductiveConstructor">here</a> <a id="AccAny.there"></a><a id="1352" href="Examples.WithMacros.Acc.html#1352" class="InductiveConstructor">there</a> <a id="1358" class="Symbol">=</a> <a id="1360" href="Generics.Reflection.Datatype.html#2190" class="Function">defineByDataD</a> <a id="1374" href="Examples.WithMacros.Acc.html#1265" class="Function">AccAnyD</a> <a id="1382" href="Examples.WithMacros.Acc.html#1328" class="Datatype">AccAny</a> <a id="1389" class="Symbol">(</a><a id="1390" href="Examples.WithMacros.Acc.html#1347" class="InductiveConstructor">AccAny.here</a> <a id="1402" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1404" href="Examples.WithMacros.Acc.html#1352" class="InductiveConstructor">AccAny.there</a> <a id="1417" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1419" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1421" class="Symbol">)</a>
<a id="1423" class="Comment">--data AccAny {ℓ&#39;&#39; ℓ ℓ&#39;} {A : Set ℓ} {R : A → A → Set ℓ&#39;}</a>
<a id="1481" class="Comment">--  (P : A → Set ℓ&#39;&#39;) : (x : A) → Acc R x → Set (ℓ ⊔ ℓ&#39; ⊔ ℓ&#39;&#39;) where</a>
<a id="1550" class="Comment">--  here  : ∀ {x accs} → P x → AccAny P x (acc accs)</a>
<a id="1603" class="Comment">--  there : ∀ {x accs y} (r : R y x)</a>
<a id="1640" class="Comment">--        → AccAny P y (accs y r) → AccAny P x (acc accs)</a>

<a id="1699" class="Keyword">instance</a>
  <a id="AccAnyC"></a><a id="1710" href="Examples.WithMacros.Acc.html#1710" class="Function">AccAnyC</a> <a id="1718" class="Symbol">:</a> <a id="1720" href="Generics.Recursion.html#674" class="Record">Named</a> <a id="1726" class="Symbol">(</a><a id="1727" class="Keyword">quote</a> <a id="1733" href="Examples.WithMacros.Acc.html#1328" class="Datatype">AccAny</a><a id="1739" class="Symbol">)</a> <a id="1741" class="Symbol">_</a>
  <a id="1745" href="Generics.Recursion.html#747" class="Field">unNamed</a> <a id="1753" href="Examples.WithMacros.Acc.html#1710" class="Function">AccAnyC</a> <a id="1761" class="Symbol">=</a> <a id="1763" href="Generics.Reflection.Connection.html#4151" class="Macro">genDataC</a> <a id="1772" href="Examples.WithMacros.Acc.html#1265" class="Function">AccAnyD</a> <a id="1780" href="Examples.WithMacros.Acc.html#1798" class="Function">AccAnyT</a>
    <a id="1792" class="Keyword">where</a> <a id="1798" href="Examples.WithMacros.Acc.html#1798" class="Function">AccAnyT</a> <a id="1806" class="Symbol">=</a> <a id="1808" href="Generics.Reflection.Uncurry.html#3452" class="Macro">genDataT</a> <a id="1817" href="Examples.WithMacros.Acc.html#1265" class="Function">AccAnyD</a> <a id="1825" href="Examples.WithMacros.Acc.html#1328" class="Datatype">AccAny</a>

<a id="1833" class="Keyword">private</a>
  <a id="lookupAnyAccP"></a><a id="1843" href="Examples.WithMacros.Acc.html#1843" class="Function">lookupAnyAccP</a> <a id="1857" class="Symbol">:</a> <a id="1859" href="Generics.Recursion.html#1055" class="Record">FoldP</a>
  <a id="1867" href="Examples.WithMacros.Acc.html#1843" class="Function">lookupAnyAccP</a> <a id="1881" class="Symbol">=</a> <a id="1883" href="Generics.SimpleContainer.Any.html#22521" class="Function">lookupAny</a> <a id="1893" class="Symbol">(</a><a id="1894" class="Keyword">quote</a> <a id="1900" href="Examples.WithMacros.Acc.html#330" class="Datatype">Acc</a><a id="1903" class="Symbol">)</a>

<a id="1906" class="Keyword">unquoteDecl</a> <a id="lookupAnyAcc"></a><a id="1918" href="Examples.WithMacros.Acc.html#1918" class="Function">lookupAnyAcc</a> <a id="1931" class="Symbol">=</a> <a id="1933" href="Generics.Reflection.Recursion.html#1320" class="Function">defineFold</a> <a id="1944" href="Examples.WithMacros.Acc.html#1843" class="Function">lookupAnyAccP</a> <a id="1958" href="Examples.WithMacros.Acc.html#1918" class="Function">lookupAnyAcc</a>
<a id="1971" class="Comment">-- lookupAnyAcc :</a>
<a id="1989" class="Comment">--   ∀ {ℓ&#39;&#39; ℓ ℓ&#39;} {A : Set ℓ} {R : A → A → Set ℓ&#39;} {P : A → Set ℓ&#39;&#39;}</a>
<a id="2058" class="Comment">--   {x : A} {a : Acc R x} → AccAny P x a → Σ A P</a>
<a id="2108" class="Comment">-- lookupAnyAcc (here p   ) = _ , p</a>
<a id="2144" class="Comment">-- lookupAnyAcc (there _ i) = lookupAnyAcc i</a>

<a id="2190" class="Keyword">instance</a> <a id="lookupAnyAccC"></a><a id="2199" href="Examples.WithMacros.Acc.html#2199" class="Function">lookupAnyAccC</a> <a id="2213" class="Symbol">=</a> <a id="2215" href="Generics.Reflection.Connection.html#4298" class="Macro">genFoldC</a> <a id="2224" href="Examples.WithMacros.Acc.html#1843" class="Function">lookupAnyAccP</a> <a id="2238" href="Examples.WithMacros.Acc.html#1918" class="Function">lookupAnyAcc</a>
</pre></body></html>