<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Examples.WithMacros.W</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--with-K</a> <a id="29" class="Symbol">#-}</a>

<a id="34" class="Keyword">module</a> <a id="41" href="Examples.WithMacros.W.html" class="Module">Examples.WithMacros.W</a> <a id="63" class="Keyword">where</a>

<a id="70" class="Keyword">open</a> <a id="75" class="Keyword">import</a> <a id="82" href="Prelude.html" class="Module">Prelude</a> <a id="90" class="Keyword">hiding</a> <a id="97" class="Symbol">(</a><a id="98" href="Prelude.List.html#5721" class="Function">lookupAny</a><a id="107" class="Symbol">)</a>

<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Generics.Description.html" class="Module">Generics.Description</a>
<a id="143" class="Keyword">open</a> <a id="148" class="Keyword">import</a> <a id="155" href="Generics.Recursion.html" class="Module">Generics.Recursion</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Generics.Reflection.html" class="Module">Generics.Reflection</a>

<a id="207" class="Keyword">open</a> <a id="212" class="Keyword">import</a> <a id="219" href="Generics.RecursionScheme.html" class="Module">Generics.RecursionScheme</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Generics.SimpleContainer.html" class="Module">Generics.SimpleContainer</a>
<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="Generics.SimpleContainer.Any.html" class="Module">Generics.SimpleContainer.Any</a>

<a id="323" class="Keyword">data</a> <a id="W"></a><a id="328" href="Examples.WithMacros.W.html#328" class="Datatype">W</a> <a id="330" class="Symbol">(</a><a id="331" href="Examples.WithMacros.W.html#331" class="Bound">A</a> <a id="333" class="Symbol">:</a> <a id="335" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="339" href="Prelude.Level.html#316" class="Generalizable">ℓ</a><a id="340" class="Symbol">)</a> <a id="342" class="Symbol">(</a><a id="343" href="Examples.WithMacros.W.html#343" class="Bound">B</a> <a id="345" class="Symbol">:</a> <a id="347" href="Examples.WithMacros.W.html#331" class="Bound">A</a> <a id="349" class="Symbol">→</a> <a id="351" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="355" href="Prelude.Level.html#318" class="Generalizable">ℓ&#39;</a><a id="357" class="Symbol">)</a> <a id="359" class="Symbol">:</a> <a id="361" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="365" class="Symbol">(</a><a id="366" href="Examples.WithMacros.W.html#339" class="Bound">ℓ</a> <a id="368" href="Agda.Primitive.html#795" class="Primitive Operator">⊔</a> <a id="370" href="Examples.WithMacros.W.html#355" class="Bound">ℓ&#39;</a><a id="372" class="Symbol">)</a> <a id="374" class="Keyword">where</a>
  <a id="W.sup"></a><a id="382" href="Examples.WithMacros.W.html#382" class="InductiveConstructor">sup</a> <a id="386" class="Symbol">:</a> <a id="388" class="Symbol">(</a><a id="389" href="Examples.WithMacros.W.html#389" class="Bound">a</a> <a id="391" class="Symbol">:</a> <a id="393" href="Examples.WithMacros.W.html#331" class="Bound">A</a><a id="394" class="Symbol">)</a> <a id="396" class="Symbol">→</a> <a id="398" class="Symbol">(</a><a id="399" href="Examples.WithMacros.W.html#343" class="Bound">B</a> <a id="401" href="Examples.WithMacros.W.html#389" class="Bound">a</a> <a id="403" class="Symbol">→</a> <a id="405" href="Examples.WithMacros.W.html#328" class="Datatype">W</a> <a id="407" href="Examples.WithMacros.W.html#331" class="Bound">A</a> <a id="409" href="Examples.WithMacros.W.html#343" class="Bound">B</a><a id="410" class="Symbol">)</a> <a id="412" class="Symbol">→</a> <a id="414" href="Examples.WithMacros.W.html#328" class="Datatype">W</a> <a id="416" href="Examples.WithMacros.W.html#331" class="Bound">A</a> <a id="418" href="Examples.WithMacros.W.html#343" class="Bound">B</a>

<a id="421" class="Keyword">instance</a>
  <a id="WC"></a><a id="432" href="Examples.WithMacros.W.html#432" class="Function">WC</a> <a id="435" class="Symbol">:</a> <a id="437" href="Generics.Recursion.html#674" class="Record">Named</a> <a id="443" class="Symbol">(</a><a id="444" class="Keyword">quote</a> <a id="450" href="Examples.WithMacros.W.html#328" class="Datatype">W</a><a id="451" class="Symbol">)</a> <a id="453" class="Symbol">_</a>
  <a id="457" href="Generics.Recursion.html#747" class="Field">unNamed</a> <a id="465" href="Examples.WithMacros.W.html#432" class="Function">WC</a> <a id="468" class="Symbol">=</a> <a id="470" href="Generics.Reflection.Connection.html#4151" class="Macro">genDataC</a> <a id="479" href="Examples.WithMacros.W.html#508" class="Function">WD</a> <a id="482" class="Symbol">(</a><a id="483" href="Generics.Reflection.Uncurry.html#3452" class="Macro">genDataT</a> <a id="492" href="Examples.WithMacros.W.html#508" class="Function">WD</a> <a id="495" href="Examples.WithMacros.W.html#328" class="Datatype">W</a><a id="496" class="Symbol">)</a>
    <a id="502" class="Keyword">where</a> <a id="508" href="Examples.WithMacros.W.html#508" class="Function">WD</a> <a id="511" class="Symbol">=</a> <a id="513" href="Generics.Reflection.Datatype.html#6792" class="Macro">genDataD</a> <a id="522" href="Examples.WithMacros.W.html#328" class="Datatype">W</a>

<a id="525" class="Comment">--------</a>
<a id="534" class="Comment">-- Transfinite induction</a>

<a id="560" class="Keyword">private</a>
  <a id="indWP"></a><a id="570" href="Examples.WithMacros.W.html#570" class="Function">indWP</a> <a id="576" class="Symbol">:</a> <a id="578" href="Generics.Recursion.html#3084" class="Record">IndP</a>
  <a id="585" href="Examples.WithMacros.W.html#570" class="Function">indWP</a> <a id="591" class="Symbol">=</a> <a id="593" href="Generics.RecursionScheme.html#9117" class="Function">ind-operator</a> <a id="606" class="Symbol">(</a><a id="607" class="Keyword">quote</a> <a id="613" href="Examples.WithMacros.W.html#328" class="Datatype">W</a><a id="614" class="Symbol">)</a>

<a id="617" class="Keyword">unquoteDecl</a> <a id="indW"></a><a id="629" href="Examples.WithMacros.W.html#629" class="Function">indW</a> <a id="634" class="Symbol">=</a> <a id="636" href="Generics.Reflection.Recursion.html#1907" class="Function">defineInd</a> <a id="646" href="Examples.WithMacros.W.html#570" class="Function">indWP</a> <a id="652" href="Examples.WithMacros.W.html#629" class="Function">indW</a>
<a id="657" class="Comment">-- indW : ∀ {ℓ&#39;&#39; ℓ ℓ&#39;} {A : Set ℓ} {B : A → Set ℓ&#39;} (P : W A B → Set ℓ&#39;&#39;)</a>
<a id="731" class="Comment">--      → ((a : A) (ws : B a → W A B) → ((b : B a) → P (ws b)) → P (sup a ws))</a>
<a id="810" class="Comment">--      → (w : W A B) → P w</a>
<a id="838" class="Comment">-- indW P s (sup a ws) = s a ws (λ b → indW P s (ws b))</a>

<a id="895" class="Keyword">instance</a> <a id="indWC"></a><a id="904" href="Examples.WithMacros.W.html#904" class="Function">indWC</a> <a id="910" class="Symbol">=</a> <a id="912" href="Generics.Reflection.Connection.html#4433" class="Macro">genIndC</a> <a id="920" href="Examples.WithMacros.W.html#570" class="Function">indWP</a> <a id="926" href="Examples.WithMacros.W.html#629" class="Function">indW</a>

<a id="932" class="Comment">--------</a>
<a id="941" class="Comment">-- Any predicate</a>

<a id="959" class="Keyword">instance</a>
  <a id="WS"></a><a id="970" href="Examples.WithMacros.W.html#970" class="Function">WS</a> <a id="973" class="Symbol">:</a> <a id="975" href="Generics.SimpleContainer.html#2387" class="Function">SCᵈ</a> <a id="979" class="Symbol">(</a><a id="980" href="Generics.Recursion.html#962" class="Function">findDataD</a> <a id="990" class="Symbol">(</a><a id="991" class="Keyword">quote</a> <a id="997" href="Examples.WithMacros.W.html#328" class="Datatype">W</a><a id="998" class="Symbol">))</a>
  <a id="1003" href="Examples.WithMacros.W.html#970" class="Function">WS</a> <a id="1006" class="Symbol">=</a> <a id="1008" class="Keyword">record</a>
    <a id="1019" class="Symbol">{</a> <a id="1021" href="Generics.SimpleContainer.html#2234" class="Field">El</a>  <a id="1025" class="Symbol">=</a> <a id="1027" class="Symbol">λ</a> <a id="1029" class="Symbol">(</a><a id="1030" href="Examples.WithMacros.W.html#1030" class="Bound">A</a> <a id="1032" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1034" class="Symbol">_)</a> <a id="1037" class="Symbol">→</a> <a id="1039" href="Examples.WithMacros.W.html#1030" class="Bound">A</a>
    <a id="1045" class="Symbol">;</a> <a id="1047" href="Generics.SimpleContainer.html#2277" class="Field">pos</a> <a id="1051" class="Symbol">=</a> <a id="1053" class="Symbol">(</a><a id="1054" href="Agda.Builtin.Bool.html#172" class="InductiveConstructor">true</a> <a id="1059" href="Prelude.List.html#5328" class="InductiveConstructor Operator">∷</a> <a id="1061" href="Agda.Builtin.Unit.html#186" class="InductiveConstructor">tt</a> <a id="1064" href="Prelude.List.html#5328" class="InductiveConstructor Operator">∷</a> <a id="1066" href="Prelude.List.html#5311" class="InductiveConstructor">[]</a><a id="1068" class="Symbol">)</a> <a id="1070" href="Prelude.List.html#5328" class="InductiveConstructor Operator">∷</a> <a id="1072" href="Prelude.List.html#5311" class="InductiveConstructor">[]</a>
    <a id="1079" class="Symbol">;</a> <a id="1081" href="Generics.SimpleContainer.html#2313" class="Field">coe</a> <a id="1085" class="Symbol">=</a> <a id="1087" class="Symbol">λ</a> <a id="1089" href="Examples.WithMacros.W.html#1089" class="Bound">_</a> <a id="1091" class="Symbol">→</a> <a id="1093" class="Symbol">(</a><a id="1094" href="Prelude.Relation.PropositionalEquality.html#1611" class="InductiveConstructor">refl</a> <a id="1099" href="Prelude.Sigma.html#1463" class="InductiveConstructor Operator">,ωω</a> <a id="1103" class="Symbol">λ</a> <a id="1105" href="Examples.WithMacros.W.html#1105" class="Bound">_</a> <a id="1107" class="Symbol">→</a> <a id="1109" href="Prelude.Level.html#547" class="InductiveConstructor">lift</a> <a id="1114" href="Agda.Builtin.Unit.html#186" class="InductiveConstructor">tt</a><a id="1116" class="Symbol">)</a> <a id="1118" href="Prelude.Sigma.html#1463" class="InductiveConstructor Operator">,ωω</a> <a id="1122" href="Prelude.Level.html#547" class="InductiveConstructor">lift</a> <a id="1127" href="Agda.Builtin.Unit.html#186" class="InductiveConstructor">tt</a> <a id="1130" class="Symbol">}</a>

<a id="1133" class="Keyword">private</a>
  <a id="WAnyD"></a><a id="1143" href="Examples.WithMacros.W.html#1143" class="Function">WAnyD</a> <a id="1149" class="Symbol">:</a> <a id="1151" href="Generics.Description.html#3148" class="Record">DataD</a>
  <a id="1159" href="Examples.WithMacros.W.html#1143" class="Function">WAnyD</a> <a id="1165" class="Symbol">=</a> <a id="1167" href="Generics.SimpleContainer.Any.html#16624" class="Function">AnyD</a> <a id="1172" class="Symbol">(</a><a id="1173" class="Keyword">quote</a> <a id="1179" href="Examples.WithMacros.W.html#328" class="Datatype">W</a><a id="1180" class="Symbol">)</a>

<a id="1183" class="Keyword">unquoteDecl</a> <a id="1195" class="Keyword">data</a> <a id="WAny"></a><a id="1200" href="Examples.WithMacros.W.html#1200" class="Datatype">WAny</a> <a id="1205" class="Keyword">constructor</a> <a id="WAny.here"></a><a id="1217" href="Examples.WithMacros.W.html#1217" class="InductiveConstructor">here</a> <a id="WAny.there"></a><a id="1222" href="Examples.WithMacros.W.html#1222" class="InductiveConstructor">there</a> <a id="1228" class="Symbol">=</a> <a id="1230" href="Generics.Reflection.Datatype.html#2190" class="Function">defineByDataD</a> <a id="1244" href="Examples.WithMacros.W.html#1143" class="Function">WAnyD</a> <a id="1250" href="Examples.WithMacros.W.html#1200" class="Datatype">WAny</a> <a id="1255" class="Symbol">(</a><a id="1256" href="Examples.WithMacros.W.html#1217" class="InductiveConstructor">WAny.here</a> <a id="1266" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1268" href="Examples.WithMacros.W.html#1222" class="InductiveConstructor">WAny.there</a> <a id="1279" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1281" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1283" class="Symbol">)</a>
<a id="1285" class="Comment">--data WAny {ℓ&#39;&#39; ℓ ℓ&#39;} {A : Set ℓ} {B : A → Set ℓ&#39;} (P : A → Set ℓ&#39;&#39;) :</a>
<a id="1357" class="Comment">--  W A B → Set (ℓ ⊔ ℓ&#39; ⊔ ℓ&#39;&#39;) where</a>
<a id="1394" class="Comment">--  here  : ∀ {a ws} → P a → WAny P (sup a ws)</a>
<a id="1441" class="Comment">--  there : ∀ {a ws} (b : B a) → WAny P (ws b) → WAny P (sup a ws)</a>

<a id="1509" class="Keyword">instance</a>
  <a id="WAnyC"></a><a id="1520" href="Examples.WithMacros.W.html#1520" class="Function">WAnyC</a> <a id="1526" class="Symbol">:</a> <a id="1528" href="Generics.Recursion.html#674" class="Record">Named</a> <a id="1534" class="Symbol">(</a><a id="1535" class="Keyword">quote</a> <a id="1541" href="Examples.WithMacros.W.html#1200" class="Datatype">WAny</a><a id="1545" class="Symbol">)</a> <a id="1547" class="Symbol">_</a>
  <a id="1551" href="Generics.Recursion.html#747" class="Field">unNamed</a> <a id="1559" href="Examples.WithMacros.W.html#1520" class="Function">WAnyC</a> <a id="1565" class="Symbol">=</a> <a id="1567" href="Generics.Reflection.Connection.html#4151" class="Macro">genDataC</a> <a id="1576" href="Examples.WithMacros.W.html#1143" class="Function">WAnyD</a> <a id="1582" href="Examples.WithMacros.W.html#1594" class="Function">WAnyT</a> <a id="1588" class="Keyword">where</a> <a id="1594" href="Examples.WithMacros.W.html#1594" class="Function">WAnyT</a> <a id="1600" class="Symbol">=</a> <a id="1602" href="Generics.Reflection.Uncurry.html#3452" class="Macro">genDataT</a> <a id="1611" href="Examples.WithMacros.W.html#1143" class="Function">WAnyD</a> <a id="1617" href="Examples.WithMacros.W.html#1200" class="Datatype">WAny</a>

<a id="1623" class="Keyword">private</a>
  <a id="lookupWAnyP"></a><a id="1633" href="Examples.WithMacros.W.html#1633" class="Function">lookupWAnyP</a> <a id="1645" class="Symbol">:</a> <a id="1647" href="Generics.Recursion.html#1055" class="Record">FoldP</a>
  <a id="1655" href="Examples.WithMacros.W.html#1633" class="Function">lookupWAnyP</a> <a id="1667" class="Symbol">=</a> <a id="1669" href="Generics.SimpleContainer.Any.html#22521" class="Function">lookupAny</a> <a id="1679" class="Symbol">(</a><a id="1680" class="Keyword">quote</a> <a id="1686" href="Examples.WithMacros.W.html#328" class="Datatype">W</a><a id="1687" class="Symbol">)</a>

<a id="1690" class="Keyword">unquoteDecl</a> <a id="lookupWAny"></a><a id="1702" href="Examples.WithMacros.W.html#1702" class="Function">lookupWAny</a> <a id="1713" class="Symbol">=</a> <a id="1715" href="Generics.Reflection.Recursion.html#1320" class="Function">defineFold</a> <a id="1726" href="Examples.WithMacros.W.html#1633" class="Function">lookupWAnyP</a> <a id="1738" href="Examples.WithMacros.W.html#1702" class="Function">lookupWAny</a>
<a id="1749" class="Comment">-- lookupWAny : ∀ {ℓ&#39;&#39; ℓ ℓ&#39;} {A : Set ℓ} {B : A → Set ℓ&#39;} {P : A → Set ℓ&#39;&#39;} {w : W A B}</a>
<a id="1837" class="Comment">--            → WAny P w → Σ A P</a>
<a id="1870" class="Comment">-- lookupWAny (here p   ) = _ , p</a>
<a id="1904" class="Comment">-- lookupWAny (there b i) = lookupWAny i</a>

<a id="1946" class="Keyword">instance</a> <a id="lookupWAnyC"></a><a id="1955" href="Examples.WithMacros.W.html#1955" class="Function">lookupWAnyC</a> <a id="1967" class="Symbol">=</a> <a id="1969" href="Generics.Reflection.Connection.html#4298" class="Macro">genFoldC</a> <a id="1978" href="Examples.WithMacros.W.html#1633" class="Function">lookupWAnyP</a> <a id="1990" href="Examples.WithMacros.W.html#1702" class="Function">lookupWAny</a>
</pre></body></html>